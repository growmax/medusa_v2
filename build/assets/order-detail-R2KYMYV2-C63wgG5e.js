import{f as ue}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{D as R,u as H}from"./chunk-K5B2ALQT-CSHvLWgD.js";import{g as pe}from"./chunk-MRWYX6AY-DEPn52yn.js";import{g as f,a as U}from"./chunk-FSMQADBD-DQ6u7KYm.js";import{i as fe,a as E}from"./chunk-OIAPXGI2-CkBelqNL.js";import{J as P}from"./chunk-3IW4HYUP-C89ww9p0.js";import{u as V}from"./chunk-KWVVOB4B-Bc14zBvB.js";import{u as he}from"./chunk-OIW3F4EQ-D8V0uZdG.js";import{r as o,q as k,h as ge,v as je,$ as ve,j as e,O as ye,a0 as be,s as Ne,u as m,C as g,H as j,T as r,L as W,a1 as _e,K as we,y as ze,b as K,a2 as Oe,x as Q,W as Ce,a3 as Ae,A as Se,n as Le,g as Ie,a4 as Ee,a5 as Pe,a6 as ke,t as L}from"./index-7A3rjJyE.js";import{T as J}from"./chunk-PHMALPVO-EKeNghx2.js";import{A as y}from"./chunk-WRXTMI2J-CygmDunM.js";import{u as X}from"./chunk-QAF7PVQE-exoP4XGT.js";import{u as Be,F as v}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as Fe}from"./zod-DRKIF09R.js";import{z as B}from"./index-yuYasa5Y.js";import{A as $e}from"./arrow-path-DMOcSYok.js";import{X as Y}from"./x-circle-DWGyIDW-.js";import{A as Me}from"./arrow-down-right-mini-XNsj1UGy.js";import{u as G}from"./use-prompt-iL3FbEo4.js";import{C as h}from"./copy-DaTMJgYc.js";import{S as C}from"./status-badge-BK5p0WUV.js";import{f as Z}from"./format-CkWRMO1y.js";import{B as ee}from"./label-DDCdtDlT.js";import"./chunk-MWVM4TYO-bKUcYSnf.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";var De=Object.defineProperty,w=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable,F=(s,t,a)=>t in s?De(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,Te=(s,t)=>{for(var a in t||(t={}))se.call(t,a)&&F(s,a,t[a]);if(w)for(var a of w(t))te.call(t,a)&&F(s,a,t[a]);return s},qe=(s,t)=>{var a={};for(var i in s)se.call(s,i)&&t.indexOf(i)<0&&(a[i]=s[i]);if(s!=null&&w)for(var i of w(s))t.indexOf(i)<0&&te.call(s,i)&&(a[i]=s[i]);return a};const ae=o.forwardRef((s,t)=>{var a=s,{color:i="currentColor"}=a,l=qe(a,["color"]);return o.createElement("svg",Te({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},l),o.createElement("g",{clipPath:"url(#a)"},o.createElement("path",{fill:i,d:"M7.5.389C3.58.389.389 3.579.389 7.5s3.19 7.111 7.111 7.111 7.111-3.19 7.111-7.111S11.421.389 7.5.389m2.693 6.915a.665.665 0 0 1-.942 0L8.167 6.22v4.168a.667.667 0 0 1-1.334 0V6.221L5.75 7.305a.667.667 0 1 1-.943-.943L7.028 4.14c.26-.26.683-.26.943 0l2.222 2.222c.26.26.26.683 0 .943"})),o.createElement("defs",null,o.createElement("clipPath",{id:"a"},o.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});ae.displayName="ArrowUpCircleSolid";var Re=Object.defineProperty,z=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,$=(s,t,a)=>t in s?Re(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,He=(s,t)=>{for(var a in t||(t={}))ie.call(t,a)&&$(s,a,t[a]);if(z)for(var a of z(t))le.call(t,a)&&$(s,a,t[a]);return s},Ue=(s,t)=>{var a={};for(var i in s)ie.call(s,i)&&t.indexOf(i)<0&&(a[i]=s[i]);if(s!=null&&z)for(var i of z(s))t.indexOf(i)<0&&le.call(s,i)&&(a[i]=s[i]);return a};const re=o.forwardRef((s,t)=>{var a=s,{color:i="currentColor"}=a,l=Ue(a,["color"]);return o.createElement("svg",He({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},l),o.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},o.createElement("path",{d:"M1.056 4.611 7.07 7.93a.89.89 0 0 0 .858 0l6.015-3.318"}),o.createElement("path",{d:"M2.833 12.611h9.334c.982 0 1.777-.796 1.777-1.778V4.167c0-.982-.796-1.778-1.777-1.778H2.833c-.981 0-1.777.796-1.777 1.778v6.666c0 .982.796 1.778 1.777 1.778"})),o.createElement("defs",null,o.createElement("clipPath",{id:"a"},o.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});re.displayName="Envelope";var Ve=Object.defineProperty,O=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,M=(s,t,a)=>t in s?Ve(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,We=(s,t)=>{for(var a in t||(t={}))ne.call(t,a)&&M(s,a,t[a]);if(O)for(var a of O(t))ce.call(t,a)&&M(s,a,t[a]);return s},Ke=(s,t)=>{var a={};for(var i in s)ne.call(s,i)&&t.indexOf(i)<0&&(a[i]=s[i]);if(s!=null&&O)for(var i of O(s))t.indexOf(i)<0&&ce.call(s,i)&&(a[i]=s[i]);return a};const de=o.forwardRef((s,t)=>{var a=s,{color:i="currentColor"}=a,l=Ke(a,["color"]);return o.createElement("svg",We({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},l),o.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 1.5v5.333M11.278 4.167H3.722c-.982 0-1.778.796-1.778 1.778v5.333c0 .982.796 1.778 1.778 1.778h7.556c.982 0 1.778-.796 1.778-1.778V5.945c0-.982-.796-1.778-1.778-1.778"}),o.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m2.167 5.086 1.288-2.598c.3-.605.917-.988 1.593-.988h4.904c.676 0 1.293.383 1.593.988l1.288 2.599M4.167 10.833h1.777"}))});de.displayName="FlyingBox";const Qe={widgets:[]},Je={widgets:[]},Xe={widgets:[]},Ye={widgets:[]};var Ge=s=>({queryKey:be.detail(s),queryFn:async()=>Ne.admin.order.retrieve(s,{fields:R})}),it=async({params:s})=>{const t=s.id,a=Ge(t);return k.getQueryData(a.queryKey)??await k.fetchQuery(a)},Ze=B.object({value:B.string().min(1)}),es=({order:s})=>{const{t}=m(),a=o.useRef(null),i=Be({defaultValues:{value:""},resolver:Fe(Ze)}),{mutateAsync:l,isLoading:n}={},c=i.handleSubmit(async u=>{l({resource_id:s.id,resource_type:"order",value:u.value},{onSuccess:()=>{i.reset(),x()}})}),d=()=>{const u=a.current;u&&(u.style.height="auto",u.style.height=u.scrollHeight+"px")},x=()=>{const u=a.current;u&&(u.style.height="auto")};return e.jsx("div",{children:e.jsx(v,{...i,children:e.jsx("form",{onSubmit:c,children:e.jsxs("div",{className:"bg-ui-bg-field shadow-borders-base flex flex-col gap-y-2 rounded-md px-2 py-1.5",children:[e.jsx(v.Field,{control:i.control,name:"value",render:({field:u})=>e.jsxs(v.Item,{children:[e.jsx(v.Label,{hidden:!0,children:t("orders.activity.comment.label")}),e.jsx(v.Control,{children:e.jsx("textarea",{...u,ref:a,onInput:d,className:"txt-small text-ui-fg-base placeholder:text-ui-fg-muted resize-none overflow-hidden bg-transparent outline-none",placeholder:t("orders.activity.comment.placeholder"),rows:1})})]})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs(Le,{type:"submit",isLoading:n,variant:"transparent",size:"small",className:"text-ui-fg-muted hover:text-ui-fg-subtle active:text-ui-fg-subtle",children:[e.jsx("span",{className:"sr-only",children:t("orders.activity.comment.addButtonText")}),e.jsx(ae,{})]})})]})})})})},ss=({order:s})=>{const t=ts(s);if(t.length<=3)return e.jsx("div",{className:"flex flex-col gap-y-0.5",children:t.map((n,c)=>e.jsx(_,{title:n.title,timestamp:n.timestamp,isFirst:c===t.length-1,children:n.children},c))});const a=t.slice(0,2),i=t.slice(2,t.length-1),l=t[t.length-1];return e.jsxs("div",{className:"flex flex-col gap-y-0.5",children:[a.map((n,c)=>e.jsx(_,{title:n.title,timestamp:n.timestamp,children:n.children},c)),e.jsx(as,{activities:i}),e.jsx(_,{title:l.title,timestamp:l.timestamp,isFirst:!0,children:l.children})]})},ts=s=>{const{t}=m(),{returns:a=[]}=H({order_id:s.id,fields:"*items"}),i=[];return o.useMemo(()=>{const n=[];for(const x of s.fulfillments)n.push({title:t("orders.activity.events.fulfillment.created"),timestamp:x.created_at,children:e.jsx(D,{fulfillment:x})}),x.shipped_at&&n.push({title:t("orders.activity.events.fulfillment.shipped"),timestamp:x.shipped_at,children:e.jsx(D,{fulfillment:x,isShipment:!0})}),x.canceled_at&&n.push({title:t("orders.activity.events.fulfillment.canceled"),timestamp:x.canceled_at});for(const x of a)n.push({title:t("orders.activity.events.return.created"),timestamp:x.created_at,children:e.jsx(is,{orderReturn:x})});s.canceled_at&&n.push({title:t("orders.activity.events.canceled.title"),timestamp:s.canceled_at});const c=n.sort((x,u)=>new Date(u.timestamp).getTime()-new Date(x.timestamp).getTime()),d={title:t("orders.activity.events.placed.title"),timestamp:s.created_at,children:e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:U(s.total,s.currency_code)})};return[...c,d]},[s,i,!1,t])},_=({title:s,timestamp:t,isFirst:a=!1,children:i})=>{const{getFullDate:l,getRelativeDate:n}=X();return e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-2",children:[e.jsxs("div",{className:"flex size-full flex-col items-center gap-y-0.5",children:[e.jsx("div",{className:"flex size-5 items-center justify-center",children:e.jsx("div",{className:"bg-ui-bg-base shadow-borders-base flex size-2.5 items-center justify-center rounded-full",children:e.jsx("div",{className:"bg-ui-tag-neutral-icon size-1.5 rounded-full"})})}),!a&&e.jsx("div",{className:"bg-ui-border-base w-px flex-1"})]}),e.jsxs("div",{className:Ie({"pb-4":!a}),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:s}),e.jsx(Q,{content:l({date:t,includeTime:!0}),children:e.jsx(r,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:n(t)})})]}),e.jsx("div",{children:i})]})]})},as=({activities:s})=>{const[t,a]=o.useState(!1),{t:i}=m();return s.length?e.jsxs(Ee,{open:t,onOpenChange:a,children:[!t&&e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-2",children:[e.jsx("div",{className:"flex size-full flex-col items-center",children:e.jsx("div",{className:"border-ui-border-strong w-px flex-1 bg-[linear-gradient(var(--border-strong)_33%,rgba(255,255,255,0)_0%)] bg-[length:1px_3px] bg-right bg-repeat-y"})}),e.jsx("div",{className:"pb-4",children:e.jsx(Pe,{className:"text-left",children:e.jsx(r,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-muted",children:i("orders.activity.showMoreActivities",{count:s.length})})})})]}),e.jsx(ke,{children:e.jsx("div",{className:"flex flex-col gap-y-0.5",children:s.map((l,n)=>e.jsx(_,{title:l.title,timestamp:l.timestamp,children:l.children},n))})})]}):null},D=({fulfillment:s})=>{const{t}=m(),a=s.items.reduce((i,l)=>i+l.quantity,0);return e.jsx("div",{children:e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:t("orders.activity.events.fulfillment.items",{count:a})})})},is=({orderReturn:s})=>{const{t}=m(),a=s.items.reduce((i,l)=>i+l.quantity,0);return e.jsx("div",{children:e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:t("orders.activity.events.return.items",{count:a})})})},ls=({order:s})=>{const{t}=m();return e.jsxs(g,{className:"flex flex-col gap-y-8 px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(j,{level:"h2",children:t("orders.activity.header")})}),e.jsx(es,{order:s})]}),e.jsx(ss,{order:s})]})},rs=({data:s})=>{const{t}=m(),a=s.customer_id,i=os(s),l=s.email,n=(i||l).charAt(0).toUpperCase();return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:t("fields.id")}),e.jsx(W,{to:`/customers/${a}`,className:"focus:shadow-borders-focus rounded-[4px] outline-none transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-x-2 overflow-hidden",children:[e.jsx(_e,{size:"2xsmall",fallback:n}),e.jsx(r,{size:"small",leading:"compact",className:"text-ui-fg-subtle hover:text-ui-fg-base transition-fg truncate",children:i||l})]})})]})},ns=({data:s})=>{var i,l;const{t}=m(),a=((i=s.shipping_address)==null?void 0:i.company)||((l=s.billing_address)==null?void 0:l.company);return a?e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:t("fields.company")}),e.jsx(r,{size:"small",leading:"compact",className:"truncate",children:a})]}):null},cs=({data:s})=>{var l,n;const{t}=m(),a=((l=s.shipping_address)==null?void 0:l.phone)||((n=s.billing_address)==null?void 0:n.phone),i=s.email;return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:t("orders.customer.contactLabel")}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_20px] items-start gap-x-2",children:[e.jsx(r,{size:"small",leading:"compact",className:"text-pretty break-all",children:i}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{content:i,className:"text-ui-fg-muted"})})]}),a&&e.jsxs("div",{className:"grid grid-cols-[1fr_20px] items-start gap-x-2",children:[e.jsx(r,{size:"small",leading:"compact",className:"text-pretty break-all",children:a}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{content:i,className:"text-ui-fg-muted"})})]})]})]})},T=({address:s,type:t})=>{const{t:a}=m();return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:a(t==="shipping"?"addresses.shippingAddress.label":"addresses.billingAddress.label")}),s?e.jsxs("div",{className:"grid grid-cols-[1fr_20px] items-start gap-x-2",children:[e.jsx(r,{size:"small",leading:"compact",children:E({address:s}).map((i,l)=>e.jsxs("span",{className:"break-words",children:[i,e.jsx("br",{})]},l))}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{content:E({address:s}).join(`
`),className:"text-ui-fg-muted"})})]}):e.jsx(r,{size:"small",leading:"compact",children:"-"})]})},ds=({data:s})=>{const{t}=m();return e.jsxs("div",{className:"divide-y",children:[e.jsx(T,{address:s.shipping_address,type:"shipping"}),fe(s.shipping_address,s.billing_address)?e.jsxs("div",{className:"grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-subtle",children:t("addresses.billingAddress.label")}),e.jsx(r,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:t("addresses.billingAddress.sameAsShipping")})]}):e.jsx(T,{address:s.billing_address,type:"billing"})]})},N=Object.assign({},{ID:rs,Company:ns,Contact:cs,Addresses:ds}),os=s=>{const{first_name:t,last_name:a}=s.shipping_address||{},{first_name:i,last_name:l}=s.billing_address||{},{first_name:n,last_name:c}=s.customer||{},d=[n,c].filter(Boolean).join(" "),x=[t,a].filter(Boolean).join(" "),u=[i,l].filter(Boolean).join(" ");return d||x||u},ms=({order:s})=>e.jsxs(g,{className:"divide-y p-0",children:[e.jsx(xs,{}),e.jsx(N.ID,{data:s}),e.jsx(N.Contact,{data:s}),e.jsx(N.Company,{data:s}),e.jsx(N.Addresses,{data:s})]}),xs=()=>{const{t:s}=m();return e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{level:"h2",children:s("fields.customer")}),e.jsx(y,{groups:[{actions:[{label:s("transferOwnership.label"),to:"transfer-ownership",icon:e.jsx($e,{})}]},{actions:[{label:s("addresses.shippingAddress.editLabel"),to:"shipping-address",icon:e.jsx(de,{})},{label:s("addresses.billingAddress.editLabel"),to:"billing-address",icon:e.jsx(we,{})}]},{actions:[{label:s("email.editLabel"),to:"email",icon:e.jsx(re,{})}]}]})]})},us=({order:s})=>{const t=s.fulfillments||[];return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx(fs,{order:s}),t.map((a,i)=>e.jsx(hs,{index:i,fulfillment:a,order:s},a.id))]})},ps=({item:s,currencyCode:t})=>e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsxs("div",{className:"flex items-start gap-x-4",children:[e.jsx(J,{src:s.thumbnail}),e.jsxs("div",{children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-base",children:s.title}),s.variant.sku&&e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsx(r,{size:"small",children:s.variant.sku}),e.jsx(h,{content:s.variant.sku,className:"text-ui-fg-muted"})]}),e.jsx(r,{size:"small",children:s.variant.options.map(a=>a.value).join(" · ")})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-x-4",children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(r,{size:"small",children:f(s.unit_price,t)})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs(r,{children:[e.jsx("span",{className:"tabular-nums",children:s.quantity-s.detail.fulfilled_quantity}),"x"]})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(r,{size:"small",children:f(s.subtotal||0,t)})})]})]},s.id),fs=({order:s})=>{const{t}=m(),a=s.items.filter(i=>i.detail.fulfilled_quantity<i.quantity);return a.length?e.jsxs(g,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{level:"h2",children:t("orders.fulfillment.unfulfilledItems")}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(C,{color:"red",className:"text-nowrap",children:t("orders.fulfillment.awaitingFulfillmentBadge")}),e.jsx(y,{groups:[{actions:[{label:t("orders.fulfillment.fulfillItems"),icon:e.jsx(ze,{}),to:`/orders/${s.id}/fulfillment`}]}]})]})]}),e.jsx("div",{children:a.map(i=>e.jsx(ps,{item:i,currencyCode:s.currency_code},i.id))})]}):null},hs=({fulfillment:s,order:t,index:a})=>{const{t:i}=m(),l=G(),n=K(),c=!!s.location_id,{stock_location:d,isError:x,error:u}=he(s.location_id,void 0,{enabled:c});let b="Awaiting shipping",A="blue",S=s.created_at;s.canceled_at?(b="Canceled",A="red",S=s.canceled_at):s.shipped_at&&(b="Shipped",A="green",S=s.shipped_at);const{mutateAsync:oe}=Oe(t.id,s.id),me=!s.canceled_at&&!s.shipped_at,xe=async()=>{if(s.shipped_at){L.warning(i("orders.fulfillment.toast.fulfillmentShipped"));return}await l({title:i("general.areYouSure"),description:i("orders.fulfillment.cancelWarning"),confirmText:i("actions.continue"),cancelText:i("actions.cancel")})&&await oe(void 0,{onSuccess:()=>{L.success(i("orders.fulfillment.toast.canceled"))},onError:I=>{L.error(I.message)}})};if(x)throw u;return e.jsxs(g,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{level:"h2",children:i("orders.fulfillment.number",{number:a+1})}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(Q,{content:Z(new Date(S),"dd MMM, yyyy, HH:mm:ss"),children:e.jsx(C,{color:A,className:"text-nowrap",children:b})}),e.jsx(y,{groups:[{actions:[{label:i("actions.cancel"),icon:e.jsx(Y,{}),onClick:xe,disabled:!!s.canceled_at}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:i("orders.fulfillment.itemsLabel")}),e.jsx("ul",{children:s.items.map(p=>e.jsx("li",{children:e.jsxs(r,{size:"small",leading:"compact",children:[p.quantity,"x ",p.title]})},p.line_item_id))})]}),c&&e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:i("orders.fulfillment.shippingFromLabel")}),d?e.jsx(W,{to:`/settings/locations/${d.id}`,className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg",children:e.jsx(r,{size:"small",leading:"compact",children:d.name})}):e.jsx(Ce,{className:"w-16"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:i("fields.provider")}),e.jsx(r,{size:"small",leading:"compact",children:ue(s.provider_id)})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",children:i("orders.fulfillment.trackingLabel")}),e.jsx("div",{children:s.labels&&s.labels.length>0?e.jsx("ul",{children:s.labels.map(p=>p.url&&p.url.length>0&&p.url!=="#"?e.jsx("li",{children:e.jsx("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",className:"text-ui-fg-interactive hover:text-ui-fg-interactive-hover transition-fg",children:e.jsx(r,{size:"small",leading:"compact",children:p.tracking_number})})},p.tracking_number):e.jsx("li",{children:e.jsx(r,{size:"small",leading:"compact",children:p.tracking_number})},p.tracking_number))}):e.jsx(r,{size:"small",leading:"compact",children:"-"})})]}),me&&e.jsx("div",{className:"bg-ui-bg-subtle flex items-center justify-end rounded-b-xl px-4 py-4",children:e.jsx(ee,{onClick:()=>n(`./${s.id}/create-shipment`),variant:"secondary",children:i("orders.fulfillment.markAsShipped")})})]})},gs=({order:s})=>{var n;const{t}=m(),a=G(),{mutateAsync:i}=Ae(s.id),l=async()=>{await a({title:t("general.areYouSure"),description:t("orders.cancelWarning",{id:`#${s.display_id}`}),confirmText:t("actions.continue"),cancelText:t("actions.cancel")})&&await i()};return e.jsxs(g,{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsxs(j,{children:["#",s.display_id]}),e.jsx(h,{content:`#${s.display_id}`,className:"text-ui-fg-muted"})]}),e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:t("orders.onDateFromSalesChannel",{date:Z(new Date(s.created_at),"dd MMM, yyyy, HH:mm:ss"),salesChannel:(n=s.sales_channel)==null?void 0:n.name})})]}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(vs,{order:s}),e.jsx(js,{order:s})]}),e.jsx(y,{groups:[{actions:[{label:t("actions.cancel"),onClick:l,icon:e.jsx(Y,{})}]}]})]})]})},js=({order:s})=>{const{t}=m(),{label:a,color:i}=pe(t,s.fulfillment_status);return e.jsx(C,{color:i,className:"text-nowrap",children:a})},vs=({order:s})=>(m(),null),ys=({order:s})=>{const{t}=m(),a=K(),{reservations:i}=V({line_item_id:s.items.map(n=>n.id)}),l=o.useMemo(()=>{var c;if(!i)return!1;const n=new Map(i.map(d=>[d.line_item_id,d.id]));for(const d of s.items)if((c=d.variant)!=null&&c.manage_inventory&&d.quantity-d.detail.fulfilled_quantity>0&&!n.has(d.id))return!0;return!1},[i]);return e.jsxs(g,{className:"divide-y divide-dashed p-0",children:[e.jsx(bs,{order:s}),e.jsx(_s,{order:s}),e.jsx(zs,{order:s}),e.jsx(ws,{order:s}),e.jsx(Os,{order:s}),l&&e.jsx("div",{className:"bg-ui-bg-subtle flex items-center justify-end rounded-b-xl px-4 py-4",children:e.jsx(ee,{onClick:()=>a("./allocate-items"),variant:"secondary",children:t("orders.allocateItems.action")})})]})},bs=({order:s})=>{const{t}=m();return e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{level:"h2",children:t("fields.summary")}),e.jsx(y,{groups:[{actions:[{label:t("orders.returns.create"),to:`/orders/${s.id}/returns`,icon:e.jsx(Se,{})}]}]})]})},Ns=({item:s,currencyCode:t,reservation:a})=>{var n;const{t:i}=m(),l=s.variant.manage_inventory;return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center gap-x-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-start gap-x-4",children:[e.jsx(J,{src:s.thumbnail}),e.jsxs("div",{children:[e.jsx(r,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-base",children:s.title}),s.variant_sku&&e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsx(r,{size:"small",children:s.variant_sku}),e.jsx(h,{content:s.variant_sku,className:"text-ui-fg-muted"})]}),e.jsx(r,{size:"small",children:(n=s.variant)==null?void 0:n.options.map(c=>c.value).join(" · ")})]})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-x-4",children:[e.jsx("div",{className:"flex items-center justify-end gap-x-4",children:e.jsx(r,{size:"small",children:f(s.unit_price,t)})}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("div",{className:"w-fit min-w-[27px]",children:e.jsxs(r,{size:"small",children:[e.jsx("span",{className:"tabular-nums",children:s.quantity}),"x"]})}),e.jsx("div",{className:"overflow-visible",children:l&&e.jsx(C,{color:a?"green":"orange",className:"text-nowrap",children:i(a?"orders.reservations.allocatedLabel":"orders.reservations.notAllocatedLabel")})})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(r,{size:"small",className:"pt-[1px]",children:f(s.subtotal||0,t)})})]})]},s.id)},_s=({order:s})=>{const{reservations:t}=V({line_item_id:s.items.map(a=>a.id)});return e.jsx("div",{children:s.items.map(a=>{const i=t?t.find(l=>l.line_item_id===a.id):null;return e.jsx(Ns,{item:a,currencyCode:s.currency_code,reservation:i},a.id)})})},q=({label:s,value:t,secondaryValue:a})=>e.jsxs("div",{className:"grid grid-cols-3 items-center",children:[e.jsx(r,{size:"small",leading:"compact",children:s}),e.jsx("div",{className:"text-right",children:e.jsx(r,{size:"small",leading:"compact",children:a})}),e.jsx("div",{className:"text-right",children:e.jsx(r,{size:"small",leading:"compact",children:t})})]}),ws=({order:s})=>{const{t}=m();return e.jsxs("div",{className:"text-ui-fg-subtle flex flex-col gap-y-2 px-6 py-4",children:[e.jsx(q,{label:t("fields.discount"),value:s.discount_total>0?`- ${f(s.discount_total,s.currency_code)}`:"-"}),e.jsx(q,{label:t("fields.shipping"),secondaryValue:s.shipping_methods.map(a=>a.name).join(", "),value:f(s.shipping_total,s.currency_code)})]})},zs=({order:s})=>{const{t}=m(),{getRelativeDate:a}=X(),{returns:i=[]}=H({order_id:s.id,status:"requested",fields:"*items"});return i.length?i.map(l=>e.jsxs("div",{className:"text-ui-fg-subtle bg-ui-bg-subtle flex flex-row justify-between gap-y-2 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"text-ui-fg-muted"}),e.jsx(r,{size:"small",className:"text-ui-fg-subtle",children:t("orders.returns.returnRequestedInfo",{requestedItemsCount:l.items.length})})]}),e.jsx(r,{size:"small",leading:"compact",className:"text-ui-fg-muted",children:a(l.created_at)})]},l.id)):null},Os=({order:s})=>{const{t}=m();return e.jsxs("div",{className:" flex flex-col gap-y-2 px-6 py-4",children:[e.jsxs("div",{className:"text-ui-fg-base flex items-center justify-between",children:[e.jsx(r,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:t("fields.total")}),e.jsx(r,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:U(s.total,s.currency_code)})]}),e.jsxs("div",{className:"text-ui-fg-base flex items-center justify-between",children:[e.jsx(r,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:t("fields.paidTotal")}),e.jsx(r,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:"-"})]})]})},lt=()=>{const s=ge(),{id:t}=je(),{order:a,isLoading:i,isError:l,error:n}=ve(t,{fields:R},{initialData:s});if(i||!a)return e.jsx("div",{children:"Loading..."});if(l)throw n;return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[Je.widgets.map((c,d)=>e.jsx("div",{children:e.jsx(c.Component,{data:a})},d)),e.jsxs("div",{className:"flex flex-col gap-x-4 lg:flex-row xl:items-start",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-3",children:[e.jsx(gs,{order:a}),e.jsx(ys,{order:a}),e.jsx(us,{order:a}),Qe.widgets.map((c,d)=>e.jsx("div",{children:e.jsx(c.Component,{data:a})},d)),e.jsx("div",{className:"hidden xl:block",children:e.jsx(P,{data:a})})]}),e.jsxs("div",{className:"mt-2 flex w-full max-w-[100%] flex-col gap-y-3 xl:mt-0 xl:max-w-[400px]",children:[Ye.widgets.map((c,d)=>e.jsx("div",{children:e.jsx(c.Component,{data:a})},d)),e.jsx(ms,{order:a}),e.jsx(ls,{order:a}),Xe.widgets.map((c,d)=>e.jsx("div",{children:e.jsx(c.Component,{data:a})},d)),e.jsx("div",{className:"xl:hidden",children:e.jsx(P,{data:a})})]})]}),e.jsx(ye,{})]})};export{lt as Component,it as loader};
