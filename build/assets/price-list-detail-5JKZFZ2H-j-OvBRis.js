import{L as Q}from"./chunk-I3VB6NM2-KfRd9ms0.js";import{u as H}from"./chunk-EIGKLERJ-Bs31FrLS.js";import{g as I}from"./chunk-G2J2T2QU-CMBJZuqd.js";import{J as b}from"./chunk-3IW4HYUP-C89ww9p0.js";import{c as K,p as $,d as D}from"./chunk-GMJC4MQM-BknCPGqF.js";import{u as J}from"./chunk-YVTBRLIE-C161Iqr5.js";import{q as w,v as M,j as e,O as Y,s as G,u as m,C as f,H as h,W as V,T as n,b as W,r as C,k as X,g as Z,t as u}from"./index-7A3rjJyE.js";import{u as U}from"./chunk-QBDU475K-BjRzsrqf.js";import{u as ee,a as se}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{A as p}from"./chunk-WRXTMI2J-CygmDunM.js";import{u as te,D as ie}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import{u as re}from"./chunk-QAF7PVQE-exoP4XGT.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as ae}from"./chunk-YBHG7T6S-BleHOTgO.js";import{P as x}from"./pencil-square-mUSTT5rR.js";import{T as L}from"./trash-C_lucST6.js";import{P as oe}from"./plus-o2nCfN-i.js";import{u as T}from"./use-prompt-iL3FbEo4.js";import{S as ce}from"./status-badge-BK5p0WUV.js";import{C as P}from"./checkbox-BD385cy_.js";import{c as ne}from"./index-DL2eSRCZ.js";import"./chunk-6GU6IDUA-CDc7wW5L.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-RYVWLLZ2-BlkKIhzO.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-TQZNQHGA-CqGicYvo.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./label-DDCdtDlT.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./format-CkWRMO1y.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";const le={widgets:[]},de={widgets:[]},me={widgets:[]},ue={widgets:[]};var pe=i=>({queryKey:$.detail(i),queryFn:async()=>G.admin.priceList.retrieve(i)}),hs=async({params:i})=>{const s=i.id,t=pe(s);return w.getQueryData(t.queryKey)??await w.fetchQuery(t)},xe=({startsAt:i,endsAt:s,showTime:t=!1})=>{const r=i?new Date(i):null,o=s?new Date(s):null,{t:a}=m(),{getFullDate:c}=re();return e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"shadow-elevation-card-rest bg-ui-bg-component text-ui-fg-subtle flex items-center gap-x-3 rounded-md px-3 py-1.5",children:[e.jsx(N,{date:r}),e.jsxs("div",{children:[e.jsx(n,{weight:"plus",size:"small",children:a("fields.startDate")}),e.jsx(n,{size:"small",className:"tabular-nums",children:r?c({date:r,includeTime:t}):"-"})]})]}),e.jsxs("div",{className:"shadow-elevation-card-rest bg-ui-bg-component text-ui-fg-subtle flex items-center gap-x-3 rounded-md px-3 py-1.5",children:[e.jsx(N,{date:o}),e.jsxs("div",{children:[e.jsx(n,{size:"small",weight:"plus",children:a("fields.endDate")}),e.jsx(n,{size:"small",className:"tabular-nums",children:o?c({date:o,includeTime:t}):"-"})]})]})]})},N=({date:i})=>{const t=i&&i>new Date;return e.jsx("div",{className:Z("bg-ui-tag-neutral-icon h-8 w-1 rounded-full",{"bg-ui-tag-orange-icon":t})})},ge=({priceList:i})=>{const{t:s}=m();return e.jsxs(f,{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{level:"h2",children:s("priceLists.configuration.header")}),e.jsx(je,{priceList:i})]}),e.jsx(p,{groups:[{actions:[{label:s("actions.edit"),to:"configuration",icon:e.jsx(x,{})}]}]})]}),e.jsx(xe,{endsAt:i.ends_at,startsAt:i.starts_at,showTime:!0})]})},je=({priceList:i})=>{const{t:s}=m(),t=i.rules.customer_group_id,{customer_groups:r,isPending:o,isError:a,error:c}=J({id:t},{enabled:!!(t!=null&&t.length)});if(a)throw c;return t!=null&&t.length?o||!r?e.jsx(V,{className:"h-5 w-full max-w-48"}):e.jsxs("div",{className:"txt-small-plus text-ui-fg-muted flex items-center gap-x-1.5",children:[e.jsx("span",{className:"text-ui-fg-subtle",children:s("priceLists.fields.customerAvailability.attribute")}),e.jsx("span",{children:"Â·"}),e.jsx(Q,{list:r.map(l=>l.name),n:1,className:"txt-small-plus text-ui-fg-muted"})]}):null},fe=({priceList:i})=>{var l;const{t:s}=m(),t=((l=i.prices)==null?void 0:l.length)||0,{color:r,text:o}=I(s,i),a=H({priceList:i}),c=i.type==="sale"?s("priceLists.fields.type.options.sale.label"):s("priceLists.fields.type.options.override.label");return e.jsxs(f,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(h,{children:i.title}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(ce,{color:r,children:o}),e.jsx(p,{groups:[{actions:[{label:s("actions.edit"),to:"edit",icon:e.jsx(x,{})}]},{actions:[{label:s("actions.delete"),onClick:a,icon:e.jsx(L,{})}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(n,{leading:"compact",size:"small",weight:"plus",children:s("fields.type")}),e.jsx(n,{size:"small",className:"text-pretty",children:c})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(n,{leading:"compact",size:"small",weight:"plus",children:s("fields.description")}),e.jsx(n,{size:"small",className:"text-pretty",children:i.description})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(n,{leading:"compact",size:"small",weight:"plus",children:s("priceLists.fields.priceOverrides.label")}),e.jsx(n,{size:"small",className:"text-pretty",children:t||"-"})]})]})},g=10,j="p",he=({priceList:i})=>{const{t:s}=m(),t=W(),r=T(),[o,a]=C.useState({}),{searchParams:c,raw:l}=ee({pageSize:g,prefix:j}),{products:k,count:v,isLoading:z,isError:A,error:E}=ae({...c,price_list_id:[i.id]},{placeholderData:X}),_=se(),y=ye(i),{mutateAsync:R}=D(i.id),{table:q}=te({data:k||[],count:v,columns:y,enablePagination:!0,enableRowSelection:!0,pageSize:g,getRowId:d=>d.id,rowSelection:{state:o,updater:a},prefix:j}),O=async()=>{await r({title:s("general.areYouSure"),description:s("priceLists.products.delete.confirmation",{count:Object.keys(o).length}),confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&R({remove:Object.keys(o)},{onSuccess:()=>{u.success(s("priceLists.products.delete.successToast",{count:Object.keys(o).length})),a({})},onError:F=>{u.error(F.message)}})},B=async()=>{const d=Object.keys(o).join(",");t(`products/edit?ids[]=${d}`)};if(A)throw E;return e.jsxs(f,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(h,{children:s("priceLists.products.header")}),e.jsx(p,{groups:[{actions:[{label:s("priceLists.products.actions.addProducts"),to:"products/add",icon:e.jsx(oe,{})},{label:s("priceLists.products.actions.editPrices"),to:"products/edit",icon:e.jsx(x,{})}]}]})]}),e.jsx(ie,{table:q,filters:_,columns:y,count:v,pageSize:g,isLoading:z,navigateTo:d=>`/products/${d.original.id}`,orderBy:["title","created_at","updated_at"],commands:[{action:B,label:s("actions.edit"),shortcut:"e"},{action:O,label:s("actions.delete"),shortcut:"d"}],pagination:!0,search:!0,prefix:j,queryObject:l})]})},ve=({product:i,priceList:s})=>{const{t}=m(),r=T(),{mutateAsync:o}=D(s.id),a=async()=>{await r({title:t("general.areYouSure"),description:t("priceLists.products.delete.confirmation",{count:1}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&o({remove:[i.id]},{onSuccess:()=>{u.success(t("priceLists.products.delete.successToast",{count:1}))},onError:l=>{u.error(l.message)}})};return e.jsx(p,{groups:[{actions:[{icon:e.jsx(x,{}),label:t("priceLists.products.actions.editPrices"),to:`products/edit?ids[]=${i.id}`}]},{actions:[{icon:e.jsx(L,{}),label:t("actions.remove"),onClick:a}]}]})},S=ne(),ye=i=>{const s=U();return C.useMemo(()=>[S.display({id:"select",header:({table:t})=>e.jsx(P,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:r=>t.toggleAllPageRowsSelected(!!r)}),cell:({row:t})=>e.jsx(P,{checked:t.getIsSelected(),onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}),...s,S.display({id:"actions",cell:({row:t})=>e.jsx(ve,{product:t.original,priceList:i})})],[s,i])},vs=()=>{const{id:i}=M(),{price_list:s,isLoading:t,isError:r,error:o}=K(i);if(t||!s)return e.jsx("div",{children:"Loading..."});if(r)throw o;return e.jsxs("div",{className:"flex flex-col gap-y-2",children:[de.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:s})},c)),e.jsxs("div",{className:"flex flex-col gap-x-4 xl:flex-row xl:items-start",children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-y-3",children:[e.jsx(fe,{priceList:s}),e.jsx(he,{priceList:s}),le.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:s})},c)),e.jsx("div",{className:"hidden xl:block",children:e.jsx(b,{data:s})})]}),e.jsxs("div",{className:"mt-2 flex w-full max-w-[100%] flex-col gap-y-2 xl:mt-0 xl:max-w-[440px]",children:[ue.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:s})},c)),e.jsx(ge,{priceList:s}),me.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:s})},c)),e.jsx("div",{className:"xl:hidden",children:e.jsx(b,{data:s})})]}),e.jsx(Y,{})]})]})};export{vs as Component,hs as loader};
