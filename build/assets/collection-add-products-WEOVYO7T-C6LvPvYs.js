import{c as z,d as F}from"./chunk-7TY4Y7TY-B3QhHT0B.js";import{u as H}from"./chunk-QBDU475K-BjRzsrqf.js";import{v as _,j as e,u as C,r as f,k as B,t as j,x as M}from"./index-7A3rjJyE.js";import{u as L,a as N}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{u as O,D as V}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as q}from"./chunk-YBHG7T6S-BleHOTgO.js";import{R as u,u as G}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as Q,H as U}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as X}from"./zod-DRKIF09R.js";import{o as Z,a as $,s as J}from"./index-yuYasa5Y.js";import{B as S}from"./label-DDCdtDlT.js";import{C as y}from"./checkbox-BD385cy_.js";import{c as K}from"./index-DL2eSRCZ.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-TQZNQHGA-CqGicYvo.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./x-mark-mini-Di7jARRp.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var W=Z({add:$(J()).min(1)}),p=50,h="p",Y=({collection:i})=>{const{t:s}=C(),{handleSuccess:t}=G(),o=Q({defaultValues:{add:[]},resolver:X(W)}),{setValue:c}=o,{mutateAsync:n,isPending:m}=F(i.id),[a,l]=f.useState({}),P=r=>{const d=typeof r=="function"?r(a):r;c("add",Object.keys(d).filter(D=>d[D]),{shouldDirty:!0,shouldTouch:!0}),l(d)};f.useEffect(()=>{c("add",Object.keys(a).filter(r=>a[r]),{shouldDirty:!0,shouldTouch:!0})},[a,c]);const{searchParams:b,raw:v}=L({prefix:h,pageSize:p}),{products:T,count:g,isLoading:R,isError:k,error:w}=q({fields:"*variants,*sales_channels",...b},{placeholderData:B}),x=te(),A=N(["collections"]),{table:E}=O({data:T??[],columns:x,count:g,pageSize:p,prefix:h,getRowId:r=>r.id,enableRowSelection:!0,rowSelection:{state:a,updater:P},enablePagination:!0,meta:{collectionId:i.id}}),I=o.handleSubmit(async r=>{await n({add:r.add},{onSuccess:()=>{j.success(s("collections.products.add.successToast",{count:r.add.length})),t()},onError:d=>{j.error(d.message)}})});if(k)throw w;return e.jsx(u.Form,{form:o,children:e.jsxs("form",{onSubmit:I,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(u.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[o.formState.errors.add&&e.jsx(U,{variant:"error",children:o.formState.errors.add.message}),e.jsx(u.Close,{asChild:!0,children:e.jsx(S,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(S,{size:"small",type:"submit",isLoading:m,children:s("actions.save")})]})}),e.jsx(u.Body,{className:"size-full overflow-hidden",children:e.jsx(V,{table:E,columns:x,pageSize:p,count:g,queryObject:v,filters:A,orderBy:["title","created_at","updated_at"],prefix:h,isLoading:R,layout:"fill",pagination:!0,search:!0})})]})})},ee=K(),te=()=>{const{t:i}=C(),s=H();return f.useMemo(()=>[ee.display({id:"select",header:({table:t})=>e.jsx(y,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:o=>t.toggleAllPageRowsSelected(!!o)}),cell:({row:t,table:o})=>{const{collectionId:c}=o.options.meta,n=t.original.collection_id===c,m=t.getIsSelected()||n,a=e.jsx(y,{checked:m,disabled:n,onCheckedChange:l=>t.toggleSelected(!!l),onClick:l=>{l.stopPropagation()}});return n?e.jsx(M,{content:i("salesChannels.productAlreadyAdded"),side:"right",children:a}):a}}),...s],[i,s])},Ne=()=>{const{id:i}=_(),{collection:s,isLoading:t,isError:o,error:c}=z(i);if(o)throw c;return e.jsx(u,{children:!t&&s&&e.jsx(Y,{collection:s})})};export{Ne as Component};
