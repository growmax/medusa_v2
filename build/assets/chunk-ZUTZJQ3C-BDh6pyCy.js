import{_ as N}from"./chunk-GH77ZQI2-CyzKiLW4.js";import{r as a,l as We,j as f,am as Q,g as He}from"./index-7A3rjJyE.js";import{u as $e,f as be,g as Ue,c as Be}from"./index-DL2eSRCZ.js";import{B as Ge}from"./label-DDCdtDlT.js";var Ye=Object.defineProperty,Z=Object.getOwnPropertySymbols,Me=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,xe=(n,i,e)=>i in n?Ye(n,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[i]=e,qe=(n,i)=>{for(var e in i||(i={}))Me.call(i,e)&&xe(n,e,i[e]);if(Z)for(var e of Z(i))ze.call(i,e)&&xe(n,e,i[e]);return n},Xe=(n,i)=>{var e={};for(var t in n)Me.call(n,t)&&i.indexOf(t)<0&&(e[t]=n[t]);if(n!=null&&Z)for(var t of Z(n))i.indexOf(t)<0&&ze.call(n,t)&&(e[t]=n[t]);return e};const _e=a.forwardRef((n,i)=>{var e=n,{color:t="currentColor"}=e,s=Xe(e,["color"]);return a.createElement("svg",qe({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:i},s),a.createElement("g",{stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},a.createElement("path",{d:"M12.611 7.5h.889M1.5 7.5h8.444M7.722 3.278H13.5M1.5 3.278h3.556M7.722 11.722H13.5M1.5 11.722h3.556M9.944 5.722v3.556M5.056 1.5v3.556M5.056 9.944V13.5"})),a.createElement("defs",null,a.createElement("clipPath",{id:"a"},a.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});_e.displayName="Adjustments";function $(n,i,e){let t=e.initialDeps??[],s;return()=>{var r,l,c,u;let x;e.key&&((r=e.debug)!=null&&r.call(e))&&(x=Date.now());const v=n();if(!(v.length!==t.length||v.some((C,S)=>t[S]!==C)))return s;t=v;let w;if(e.key&&((l=e.debug)!=null&&l.call(e))&&(w=Date.now()),s=i(...v),e.key&&((c=e.debug)!=null&&c.call(e))){const C=Math.round((Date.now()-x)*100)/100,S=Math.round((Date.now()-w)*100)/100,D=S/16,d=(I,_)=>{for(I=String(I);I.length<_;)I=" "+I;return I};console.info(`%c⏱ ${d(S,5)} /${d(C,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*D,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(u=e==null?void 0:e.onChange)==null||u.call(e,s),s}}function le(n,i){if(n===void 0)throw new Error("Unexpected undefined");return n}const Je=(n,i)=>Math.abs(n-i)<1,Qe=(n,i,e)=>{let t;return function(...s){n.clearTimeout(t),t=n.setTimeout(()=>i.apply(this,s),e)}},Ze=n=>n,et=n=>{const i=Math.max(n.startIndex-n.overscan,0),e=Math.min(n.endIndex+n.overscan,n.count-1),t=[];for(let s=i;s<=e;s++)t.push(s);return t},tt=(n,i)=>{const e=n.scrollElement;if(!e)return;const t=n.targetWindow;if(!t)return;const s=l=>{const{width:c,height:u}=l;i({width:Math.round(c),height:Math.round(u)})};if(s(e.getBoundingClientRect()),!t.ResizeObserver)return()=>{};const r=new t.ResizeObserver(l=>{const c=l[0];if(c!=null&&c.borderBoxSize){const u=c.borderBoxSize[0];if(u){s({width:u.inlineSize,height:u.blockSize});return}}s(e.getBoundingClientRect())});return r.observe(e,{box:"border-box"}),()=>{r.unobserve(e)}},we={passive:!0},st=typeof window>"u"?!0:"onscrollend"in window,nt=(n,i)=>{const e=n.scrollElement;if(!e)return;const t=n.targetWindow;if(!t)return;let s=0;const r=st?()=>{}:Qe(t,()=>{i(s,!1)},n.options.isScrollingResetDelay),l=x=>()=>{s=e[n.options.horizontal?"scrollLeft":"scrollTop"],r(),i(s,x)},c=l(!0),u=l(!1);return u(),e.addEventListener("scroll",c,we),e.addEventListener("scrollend",u,we),()=>{e.removeEventListener("scroll",c),e.removeEventListener("scrollend",u)}},it=(n,i,e)=>{if(i!=null&&i.borderBoxSize){const t=i.borderBoxSize[0];if(t)return Math.round(t[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(n.getBoundingClientRect()[e.options.horizontal?"width":"height"])},rt=(n,{adjustments:i=0,behavior:e},t)=>{var s,r;const l=n+i;(r=(s=t.scrollElement)==null?void 0:s.scrollTo)==null||r.call(s,{[t.options.horizontal?"left":"top"]:l,behavior:e})};class ot{constructor(i){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(s=>{s.forEach(r=>{this._measureElement(r.target,r)})}));return{disconnect:()=>{var s;return(s=t())==null?void 0:s.disconnect()},observe:s=>{var r;return(r=t())==null?void 0:r.observe(s,{box:"border-box"})},unobserve:s=>{var r;return(r=t())==null?void 0:r.unobserve(s)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,s])=>{typeof s>"u"&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Ze,rangeExtractor:et,onChange:()=>{},measureElement:it,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,...e}},this.notify=(e,t)=>{var s,r;const{startIndex:l,endIndex:c}=this.range??{startIndex:void 0,endIndex:void 0},u=this.calculateRange();(e||l!==(u==null?void 0:u.startIndex)||c!==(u==null?void 0:u.endIndex))&&((r=(s=this.options).onChange)==null||r.call(s,this,t))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.observer.disconnect(),this.elementsCache.clear()},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t){this.notify(!1,!1);return}this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(s,r)=>{this.scrollAdjustments=0,this.scrollDirection=r?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s;const l=this.isScrolling;this.isScrolling=r,this.notify(l!==r,r)}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const s=new Map,r=new Map;for(let l=t-1;l>=0;l--){const c=e[l];if(s.has(c.lane))continue;const u=r.get(c.lane);if(u==null||c.end>u.end?r.set(c.lane,c):c.end<u.end&&s.set(c.lane,!0),s.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((l,c)=>l.end===c.end?l.index-c.index:l.end-c.end)[0]:void 0},this.getMeasurementOptions=$(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,t,s,r,l)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:s,getItemKey:r,enabled:l}),{key:!1}),this.getMeasurements=$(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:s,getItemKey:r,enabled:l},c)=>{var u;if(!l)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(g=>{this.itemSizeCache.set(g.key,g.size)}));const x=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,x);for(let g=x;g<e;g++){let w=(u=this.measurementsCache[g])==null?void 0:u.measureElement;w||(w=M=>{const V=r(g),E=this.elementsCache.get(V);if(!M){E&&(this.observer.unobserve(E),this.elementsCache.delete(V));return}E!==M&&(E&&this.observer.unobserve(E),this.observer.observe(M),this.elementsCache.set(V,M)),M.isConnected&&this.resizeItem(g,this.options.measureElement(M,void 0,this))});const C=r(g),S=this.options.lanes===1?v[g-1]:this.getFurthestMeasurement(v,g),D=S?S.end+this.options.gap:t+s,d=c.get(C),I=typeof d=="number"?d:this.options.estimateSize(g),_=D+I,j=S?S.lane:g%this.options.lanes;v[g]={index:g,start:D,size:I,end:_,key:C,lane:j,measureElement:w}}return this.measurementsCache=v,v},{key:"getMeasurements",debug:()=>this.options.debug}),this.calculateRange=$(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(e,t,s)=>this.range=e.length>0&&t>0?lt({measurements:e,outerSize:t,scrollOffset:s}):null,{key:"calculateRange",debug:()=>this.options.debug}),this.getIndexes=$(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,t,s,r)=>t===null?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:s,count:r}),{key:"getIndexes",debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,s=e.getAttribute(t);return s?parseInt(s,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const s=this.indexFromElement(e),r=this.getMeasurements()[s];if(!r||!e.isConnected){this.elementsCache.forEach((c,u)=>{c===e&&(this.observer.unobserve(e),this.elementsCache.delete(u))});return}const l=this.elementsCache.get(r.key);l!==e&&(l&&this.observer.unobserve(l),this.observer.observe(e),this.elementsCache.set(r.key,e)),this.resizeItem(s,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const s=this.getMeasurements()[e];if(!s)return;const r=this.itemSizeCache.get(s.key)??s.size,l=t-r;l!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,l,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&(this.options.debug&&console.info("correction",l),this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=l,behavior:void 0})),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,t)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=$(()=>[this.getIndexes(),this.getMeasurements()],(e,t)=>{const s=[];for(let r=0,l=e.length;r<l;r++){const c=e[r],u=t[c];s.push(u)}return s},{key:"getIndexes",debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(t.length!==0)return le(t[Oe(0,t.length-1,s=>le(t[s]).start,e)])},this.getOffsetForAlignment=(e,t)=>{const s=this.getSize(),r=this.getScrollOffset();t==="auto"&&(e<=r?t="start":e>=r+s?t="end":t="start"),t==="start"?e=e:t==="end"?e=e-s:t==="center"&&(e=e-s/2);const l=this.options.horizontal?"scrollWidth":"scrollHeight",u=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[l]:this.scrollElement[l]:0)-s;return Math.max(Math.min(u,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const s=this.getMeasurements()[e];if(!s)return;const r=this.getSize(),l=this.getScrollOffset();if(t==="auto")if(s.end>=l+r-this.options.scrollPaddingEnd)t="end";else if(s.start<=l+this.options.scrollPaddingStart)t="start";else return[l,t];const c=t==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(c,t),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:s})},this.scrollToIndex=(e,{align:t="auto",behavior:s}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const r=this.getOffsetForIndex(e,t);if(!r)return;const[l,c]=r;this._scrollToOffset(l,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[x]=le(this.getOffsetForIndex(e,c));Je(x,this.getScrollOffset())||this.scrollToIndex(e,{align:c,behavior:s})}else this.scrollToIndex(e,{align:c,behavior:s})}))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let s;return t.length===0?s=this.options.paddingStart:s=this.options.lanes===1?((e=t[t.length-1])==null?void 0:e.end)??0:Math.max(...t.slice(-this.options.lanes).map(r=>r.end)),s-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:t,behavior:s})=>{this.options.scrollToFn(e,{behavior:s,adjustments:t},this)},this.measure=()=>{var e,t;this.itemSizeCache=new Map,(t=(e=this.options).onChange)==null||t.call(e,this,!1)},this.setOptions(i)}}const Oe=(n,i,e,t)=>{for(;n<=i;){const s=(n+i)/2|0,r=e(s);if(r<t)n=s+1;else if(r>t)i=s-1;else return s}return n>0?n-1:0};function lt({measurements:n,outerSize:i,scrollOffset:e}){const t=n.length-1,r=Oe(0,t,c=>n[c].start,e);let l=r;for(;l<t&&n[l].end<e+i;)l++;return{startIndex:r,endIndex:l}}const at=typeof document<"u"?a.useLayoutEffect:a.useEffect;function ct(n){const i=a.useReducer(()=>({}),{})[1],e={...n,onChange:(s,r)=>{var l;r?We.flushSync(i):i(),(l=n.onChange)==null||l.call(n,s,r)}},[t]=a.useState(()=>new ot(e));return t.setOptions(e),a.useEffect(()=>t._didMount(),[]),at(()=>t._willUpdate()),t}function Ce(n){return ct({observeElementRect:tt,observeElementOffset:nt,scrollToFn:rt,...n})}var ut=(n=20)=>{const[i,e]=a.useState([]),[t,s]=a.useState([]),r=i.length>0,l=t.length>0,c=a.useCallback(()=>{if(!r)return;const v=i[i.length-1],g=i.slice(0,i.length-1);v.undo(),e(g),s([v,...t.slice(0,n-1)])},[r,t,i,n]),u=a.useCallback(()=>{if(!l)return;const v=t[0],g=t.slice(1);v.redo(),e([...i,v].slice(0,n-1)),s(g)},[l,t,i,n]),x=a.useCallback(v=>{v.execute(),e(g=>[...g,v].slice(0,n-1)),s([])},[n]);return{undo:c,redo:u,execute:x,canUndo:r,canRedo:l}},ke=a.createContext(null),Ee=class{constructor(n){N(this,"items",[]),n&&this.insertMultiple(n)}insert(n){const i=this.findInsertionIndex(n);this.items[i]!==n&&this.items.splice(i,0,n)}remove(n){const i=this.findInsertionIndex(n);this.items[i]===n&&this.items.splice(i,1)}getPrev(n){const i=this.findInsertionIndex(n);return i===0?null:this.items[i-1]}getNext(n){const i=this.findInsertionIndex(n);return i===this.items.length-1?null:this.items[i+1]}getFirst(){return this.items.length===0?null:this.items[0]}getLast(){return this.items.length===0?null:this.items[this.items.length-1]}toArray(){return[...this.items]}insertMultiple(n){n.forEach(i=>this.insert(i))}findInsertionIndex(n){let i=0,e=this.items.length-1;for(;i<=e;){const t=Math.floor((i+e)/2);if(this.items[t]===n)return t;this.items[t]<n?i=t+1:e=t-1}return i}},ye=class{constructor({selection:n,prev:i,next:e,setter:t}){N(this,"_selection"),N(this,"_prev"),N(this,"_next"),N(this,"_setter"),this._selection=n,this._prev=i,this._next=e,this._setter=t}execute(){this._setter(this._selection,this._next)}undo(){this._setter(this._selection,this._prev)}redo(){this.execute()}},ht=class{constructor({prev:n,next:i,setter:e}){N(this,"_prev"),N(this,"_next"),N(this,"_setter"),this._prev=n,this._next=i,this._setter=e}execute(){this._setter(this._next)}undo(){this._setter(this._prev)}redo(){this.execute()}};function k(n){return`${n.row}:${n.col}`}function dt(n){const[i,e]=n.split(":").map(Number);if(isNaN(i)||isNaN(e))throw new Error(`Invalid cell id: ${n}`);return{row:i,col:e}}function De(n,i){return i?n.row===i.row&&n.col===i.col:!1}var Se=(n,i)=>{const e={},t=Math.min(n.col,i.col),s=Math.max(n.col,i.col),r=Math.min(n.row,i.row),l=Math.max(n.row,i.row);for(let c=t;c<=s;c++)for(let u=r;u<=l;u++)e[k({row:u,col:c})]=!0;return e};function Ie(n,i){if(i=i||document.body,!i)return[];const e=Object.keys(n);return e.length?e.map(s=>{const r=i.querySelector(`[data-cell-id="${s}"][data-field]`);return r?r.getAttribute("data-field"):null}):[]}function ft(n,i){const e=[];for(const t of n)if(i==="number"){const s=Number(t);if(isNaN(s))throw new Error(`String "${t}" cannot be converted to number.`);e.push(s)}else if(i==="boolean"){const s=t.toLowerCase();if(s==="true"||s==="false")e.push(s==="true");else throw new Error(`String "${t}" cannot be converted to boolean.`)}else if(i==="string")e.push(String(t));else throw new Error(`Unsupported target type "${i}".`);return e}function Mt(){const n=Be();return{column:({id:i,name:e,header:t,cell:s,type:r="string",asString:l,disableHiding:c=!1})=>n.display({id:i,header:t,cell:s,enableHiding:!c,meta:{type:r,asString:l,name:e}})}}function mt(n){const i=n.columnDef.id,e=n==null?void 0:n.columnDef.meta;if(!i)throw new Error("Column is missing an id, which is a required field. Please provide an id for the column.");return e!=null&&e.name||console.warn(`Column "${i}" does not have a name. You should add a name to the column definition. Falling back to the column id.`),(e==null?void 0:e.name)||i}function gt(n,i){const{col:e}=dt(n),t=i[e],s=t==null?void 0:t.columnDef.meta;return(s==null?void 0:s.type)||"string"}var pt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],vt=["ArrowUp","ArrowDown"],bt=40,zt=({data:n=[],columns:i,state:e,getSubRows:t})=>{var ge,pe;const s=a.useRef(null),{redo:r,undo:l,execute:c}=ut(),{register:u,control:x,getValues:v,setValue:g}=e,w=a.useMemo(()=>new Ee,[]),C=a.useMemo(()=>new Ee,[]),[S,D]=a.useState({}),[d,I]=a.useState(null),[_,j]=a.useState(null),[M,V]=a.useState(null),[E,U]=a.useState({}),[L,ee]=a.useState({}),[te,ae]=a.useState(!1),[B,ce]=a.useState(!1),[Ct,ue]=a.useState(!1),[je,Re]=a.useState({}),G=$e({data:n,columns:i,state:{columnVisibility:je},onColumnVisibilityChange:Re,getSubRows:t,getCoreRowModel:Ue(),defaultColumn:{size:200,maxSize:400}}),{flatRows:he}=G.getRowModel(),Y=Ce({count:he.length,estimateSize:()=>bt,getScrollElement:()=>s.current,overscan:5}),Te=Y.getVirtualItems(),F=G.getVisibleLeafColumns(),K=Ce({count:F.length,estimateSize:o=>F[o].getSize(),getScrollElement:()=>s.current,horizontal:!0,overscan:3}),A=K.getVirtualItems();let W,H;K&&(A!=null&&A.length)&&(W=((ge=A[0])==null?void 0:ge.start)??0,H=K.getTotalSize()-(((pe=A[A.length-1])==null?void 0:pe.end)??0));const Ae=a.useCallback(o=>{w.insert(o.col),C.insert(o.row);const h=k(o);D(m=>({...m,[h]:!0}))},[w,C]),Ne=a.useCallback(o=>{w.remove(o.col),C.remove(o.row);const h=k(o);D(m=>{const p={...m};return delete p[h],p})},[w,C]),q=a.useCallback(o=>{const h=document.activeElement;h instanceof HTMLElement&&h.blur(),I(o)},[]),X=a.useCallback(o=>{const h=Object.keys(E),m=d?k(d):null,p=o?k(o):null;h.length===1&&m===h[0]&&(m&&p&&m===p)||(q(null),U({}),j(null)),ee({})},[d,E,q]),se=a.useCallback(o=>{X(o),q(o),j(o)},[X,q]),P=a.useCallback(o=>Object.keys(o).length?Ie(o,s.current).map(p=>p?`${v(p)}`:""):[],[v]),J=a.useCallback((o,h)=>{const m=Object.keys(o);if(!m.length)return;const p=gt(m[0],F),b=ft(h,p);Ie(o,s.current).forEach((y,R)=>{if(!y)return;const T=R%h.length,z=b[T];g(y,z)})},[g,F]),de=a.useCallback(o=>{const h=vt.includes(o.key)?"vertical":"horizontal",m=h==="horizontal"?d:o.shiftKey?_:d,p=h==="horizontal"?K:Y,b=h==="horizontal"?w:C,O=h==="horizontal"?se:o.shiftKey?j:se;if(!m)return;const{row:y,col:R}=m,T=z=>{if(z===null)return;o.preventDefault(),p.scrollToIndex(z,{align:"center",behavior:"auto"}),O(h==="horizontal"?{row:y,col:z}:{row:z,col:R})};switch(o.key){case"ArrowLeft":case"ArrowUp":{const z=o.metaKey||o.ctrlKey?b.getFirst():b.getPrev(h==="horizontal"?R:y);T(z);break}case"ArrowRight":case"ArrowDown":{const z=o.metaKey||o.ctrlKey?b.getLast():b.getNext(h==="horizontal"?R:y);T(z);break}}},[d,_,w,C,K,Y,se,j]),fe=a.useCallback(o=>{if(o.preventDefault(),o.shiftKey){r();return}l()},[r,l]),ne=a.useCallback(o=>{pt.includes(o.key)&&de(o),o.key==="z"&&(o.metaKey||o.ctrlKey)&&fe(o)},[de,fe]),me=a.useCallback(()=>{if(!B||!d||!M||!Object.keys(L).length)return;const o=k(d),h=P({[o]:!0}),{[o]:m,...p}=L,b=P(p),O=Array.from({length:b.length},()=>h[0]),y=new ye({selection:p,prev:b,next:O,setter:J});c(y),ce(!1),V(null),ee({}),U(L)},[B,d,M,L,P,J,c]),ie=a.useCallback(()=>{me(),ae(!1)},[me]),re=a.useCallback(o=>{var p;if(!E)return;o.preventDefault();const m=P(E).map(b=>b??"").join("	");(p=o.clipboardData)==null||p.setData("text/plain",m)},[E,P]),oe=a.useCallback(o=>{var O;o.preventDefault();const h=(O=o.clipboardData)==null?void 0:O.getData("text/plain");if(!h)return;const m=h.split("	"),p=P(E),b=new ye({selection:E,next:m,prev:p,setter:J});c(b)},[E,P,J,c]);a.useEffect(()=>(window.addEventListener("keydown",ne),window.addEventListener("mouseup",ie),window.addEventListener("copy",re),window.addEventListener("paste",oe),()=>{window.removeEventListener("keydown",ne),window.removeEventListener("mouseup",ie),window.removeEventListener("copy",re),window.removeEventListener("paste",oe)}),[ne,ie,re,oe]);const Pe=a.useCallback(o=>h=>{if(h.shiftKey){j(o);return}ae(!0),X(o),I(o)},[X]),Ve=a.useCallback(o=>{if(!(!B&&!te))return h=>{(d==null?void 0:d.col)===o.col&&(te?j(o):V(o))}},[d,B,te]);a.useCallback(()=>{ue(!0)},[]),a.useCallback(()=>{ue(!1)},[]);const Le=a.useCallback(o=>{ce(!0)},[]),Fe=a.useCallback(o=>(h,m)=>{const p=new ht({next:h,prev:m,setter:b=>{g(o,b)}});c(p)},[g,c]);return a.useEffect(()=>{if(!d||!_)return;const o=Se(d,_);U(o)},[d,_]),a.useEffect(()=>{if(!d||!M)return;const o=Se(d,M);ee(o)},[d,M]),a.useEffect(()=>{d&&U(o=>({...o,[k(d)]:!0}))},[d]),a.useEffect(()=>{d&&(_||j(d))},[d,_]),f.jsx(ke.Provider,{value:{register:u,control:x,anchor:d,onRegisterCell:Ae,onUnregisterCell:Ne,getMouseDownHandler:Pe,getMouseOverHandler:Ve,getOnChangeHandler:Fe},children:f.jsxs("div",{className:"bg-ui-bg-subtle flex size-full flex-col overflow-hidden",children:[f.jsx("div",{className:"bg-ui-bg-base flex items-center justify-between border-b p-4",children:f.jsxs(Q,{children:[f.jsx(Q.Trigger,{asChild:!0,children:f.jsxs(Ge,{size:"small",variant:"secondary",children:[f.jsx(_e,{}),"Edit columns"]})}),f.jsx(Q.Content,{children:G.getAllLeafColumns().map(o=>{const h=o.getIsVisible();return o.getCanHide()?f.jsx(Q.CheckboxItem,{checked:h,onCheckedChange:p=>o.toggleVisibility(p),onSelect:p=>p.preventDefault(),children:mt(o)},o.id):null})})]})}),f.jsx("div",{ref:s,className:"relative h-full select-none overflow-auto",children:f.jsxs("table",{className:"text-ui-fg-subtle grid",children:[f.jsx("thead",{className:"txt-compact-small-plus bg-ui-bg-subtle sticky top-0 z-[1] grid",children:G.getHeaderGroups().map(o=>f.jsxs("tr",{className:"flex h-10 w-full",children:[W?f.jsx("th",{style:{display:"flex",width:W}}):null,A.map(h=>{const m=o.headers[h.index];return f.jsx("th",{"data-column-index":h.index,style:{width:m.getSize()},className:"bg-ui-bg-base txt-compact-small-plus flex items-center border-b border-r px-4 py-2.5",children:m.isPlaceholder?null:be(m.column.columnDef.header,m.getContext())},m.id)}),H?f.jsx("th",{style:{display:"flex",width:H}}):null]},o.id))}),f.jsx("tbody",{className:"relative grid",style:{height:`${Y.getTotalSize()}px`},children:Te.map(o=>{const h=he[o.index],m=h.getVisibleCells();return f.jsxs("tr",{style:{transform:`translateY(${o.start}px)`},className:"bg-ui-bg-subtle txt-compact-small absolute flex h-10 w-full",children:[W?f.jsx("td",{style:{display:"flex",width:W}}):null,A.map(p=>{const b=m[p.index],O=b.column,y=F.findIndex(Ke=>Ke.id===O.id),R={row:o.index,col:y},T=De(R,d),z=E[k(R)],ve=L[k(R)];return f.jsx("td",{style:{width:b.column.getSize()},"data-row-index":o.index,"data-column-index":y,className:He("bg-ui-bg-base relative flex items-center border-b border-r p-0 outline-none","after:transition-fg after:border-ui-fg-interactive after:pointer-events-none after:invisible after:absolute after:-bottom-px after:-left-px after:-right-px after:-top-px after:box-border after:border-[2px] after:content-['']",{"after:visible":T,"bg-ui-bg-highlight focus-within:bg-ui-bg-base":z||T,"bg-ui-bg-subtle":ve&&!T}),tabIndex:-1,children:f.jsxs("div",{className:"relative h-full w-full",children:[be(b.column.columnDef.cell,{...b.getContext(),columnIndex:y,rowIndex:o.index}),T&&f.jsx("div",{onMouseDown:Le,className:"bg-ui-fg-interactive absolute bottom-0 right-0 z-[3] size-1.5 cursor-ns-resize"})]})},b.id)}),H?f.jsx("td",{style:{display:"flex",width:H}}):null]},h.id)})})]})})]})})},_t=({children:n})=>f.jsx("div",{className:"bg-ui-bg-subtle txt-compact-small text-ui-fg-subtle flex size-full cursor-not-allowed items-center px-4 py-2.5 outline-none",children:f.jsx("span",{children:n})}),xt=()=>{const n=a.useContext(ke);if(!n)throw new Error("useDataGridContext must be used within a DataGridContextProvider");return n},Ot=({field:n,context:i})=>{const{rowIndex:e,columnIndex:t}=i,s=a.useMemo(()=>({row:e,col:t}),[e,t]),r=k(s),{register:l,control:c,anchor:u,onRegisterCell:x,onUnregisterCell:v,getMouseOverHandler:g,getMouseDownHandler:w,getOnChangeHandler:C}=xt();a.useEffect(()=>(x(s),()=>{v(s)}),[s,x,v]);const S={isAnchor:u?De(s,u):!1,wrapper:{onMouseDown:w(s),onMouseOver:g(s)},overlay:{onClick:()=>{}}},D={"data-row":s.row,"data-col":s.col,"data-cell-id":r,"data-field":n};return{id:r,register:l,control:c,attributes:D,container:S,onChange:C(n)}},kt=({isAnchor:n,placeholder:i,overlay:e,wrapper:t,children:s})=>f.jsx("div",{className:"static size-full",children:f.jsx("div",{className:"flex size-full items-start outline-none",tabIndex:-1,children:f.jsxs("div",{...t,className:"relative size-full min-w-0 flex-1",children:[f.jsx("div",{className:"relative z-[1] flex size-full items-center justify-center",children:f.jsx(wt,{isAnchor:n,placeholder:i,children:s})}),!n&&f.jsx("div",{...e,tabIndex:-1,className:"absolute inset-0 z-[2] size-full"})]})})}),wt=({isAnchor:n,placeholder:i,children:e})=>!n&&i?i:e;export{zt as D,_t as a,kt as b,Mt as c,Ot as u};
