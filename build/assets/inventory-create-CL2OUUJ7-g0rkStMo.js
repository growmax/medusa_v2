import{C as D}from"./chunk-FLW5D3SP-2BTcEG50.js";import{a as H}from"./chunk-OIW3F4EQ-D8V0uZdG.js";import{o as g}from"./chunk-Y2QXUTMB-CYOiJYmV.js";import{D as q,a as R,u as E,b as G,c as M}from"./chunk-ZUTZJQ3C-BDh6pyCy.js";import{d as z,i as P}from"./chunk-DMYZ6SLX-BMyt3Z-P.js";import{j as e,u as L,R as y,s as A,q as B,t as I,r as C,g as O,H as k,I as o}from"./index-7A3rjJyE.js";import{R as h,u as V}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as K,F as t}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as Q}from"./zod-DRKIF09R.js";import{o as $,s as c,b as U,r as J,n as W}from"./index-yuYasa5Y.js";import{P as u}from"./progress-tabs-CBvjkL6b.js";import{B as F}from"./label-DDCdtDlT.js";import{T as X}from"./textarea-Cvx7IHRI.js";import{S as Y}from"./switch-DDIyRuzh.js";import"./triangles-mini-JWkpofVU.js";import"./chunk-6GU6IDUA-CDc7wW5L.js";import"./chunk-GH77ZQI2-CyzKiLW4.js";import"./index-DL2eSRCZ.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var Z=({field:i,context:n,...s})=>{const{register:m,attributes:l,container:v}=E({field:i,context:n});return e.jsx(G,{...v,children:e.jsx("input",{...l,type:"number",...m(i,{valueAsNumber:!0,onChange:x=>{if(x.target.value){const p=Number(x.target.value);return Number.isNaN(p)?void 0:p}}}),className:"h-full w-full bg-transparent p-2 text-right [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",...s})})},ee=({form:i})=>{const{isPending:n,stock_locations:s=[]}=H({limit:999}),m=te();return e.jsx("div",{className:"flex size-full flex-col divide-y overflow-hidden",children:n?e.jsx("div",{children:"Loading..."}):e.jsx(q,{columns:m,data:s,state:i})})},S=M(),te=()=>{const{t:i}=L();return C.useMemo(()=>[S.column({id:"location",header:()=>e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:i("locations.domain")})}),cell:({row:n})=>e.jsx(R,{children:n.original.name}),disableHiding:!0}),S.column({id:"in-stock",name:i("fields.inStock"),header:i("fields.inStock"),cell:n=>e.jsx(Z,{min:0,placeholder:"0",context:n,field:`locations.${n.row.original.id}`}),disableHiding:!0})],[i])},re=$({title:c().min(1),sku:c().optional(),hs_code:c().optional(),weight:g,length:g,height:g,width:g,origin_country:c().optional(),mid_code:c().optional(),material:c().optional(),description:c().optional(),requires_shipping:U().optional(),thumbnail:c().optional(),locations:J(c(),W().optional()).optional()});function ie({}){const{t:i}=L(),{handleSuccess:n}=V(),[s,m]=y.useState("details"),l=K({defaultValues:{title:"",sku:"",hs_code:"",weight:"",length:"",height:"",width:"",origin_country:"",mid_code:"",material:"",description:"",requires_shipping:!0,thumbnail:""},resolver:Q(re)}),{mutateAsync:v,isPending:x}=z(),p=l.handleSubmit(async r=>{const{locations:f,...d}=r;for(const a in d){if(d[a]===""){delete d[a];continue}["weight","length","height","width"].includes(a)&&(d[a]=parseInt(d[a]))}try{const{inventory_item:a}=await v(d);try{await A.admin.inventoryItem.batchUpdateLevels(a.id,{create:Object.entries(f).filter(([b,w])=>!!w).map(([b,w])=>({location_id:b,stocked_quantity:w}))}),await B.invalidateQueries({queryKey:P.lists()})}catch(b){I.error(b.message)}n()}catch(a){I.error(a.message)}}),[N,j]=y.useState({availability:"not-started",details:"not-started"}),_=y.useCallback(async r=>{await l.trigger()&&m(r)},[]),T=y.useCallback(async()=>{if(await l.trigger())switch(s){case"details":{m("availability");break}}},[s]);return C.useEffect(()=>{l.formState.isDirty?j(r=>({...r,details:"in-progress"})):j(r=>({...r,details:"not-started"}))},[l.formState.isDirty]),C.useEffect(()=>{s==="details"&&l.formState.isDirty&&j(r=>({...r,details:"in-progress"})),s==="availability"&&j(r=>({...r,details:"completed",availability:"in-progress"}))},[s]),e.jsx(h.Form,{form:l,children:e.jsx("form",{className:"flex h-full flex-col overflow-hidden",onSubmit:p,children:e.jsxs(u,{value:s,className:"h-full",onValueChange:r=>_(r),children:[e.jsxs(h.Header,{children:[e.jsxs(u.List,{className:"border-ui-border-base -my-2 ml-2 min-w-0 flex-1 border-l",children:[e.jsx(u.Trigger,{value:"details",status:N.details,className:"w-full max-w-[200px]",children:e.jsx("span",{className:"w-full cursor-auto overflow-hidden text-ellipsis whitespace-nowrap",children:i("inventory.create.details")})}),e.jsx(u.Trigger,{value:"availability",className:"w-full max-w-[200px]",status:N.availability,children:e.jsx("span",{className:"w-full overflow-hidden text-ellipsis whitespace-nowrap",children:i("inventory.create.availability")})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(h.Close,{asChild:!0,children:e.jsx(F,{variant:"secondary",size:"small",children:i("actions.cancel")})}),e.jsx(F,{size:"small",className:"whitespace-nowrap",isLoading:x,onClick:s!=="availability"?T:void 0,type:s==="availability"?"submit":"button",children:i(s==="availability"?"actions.save":"general.next")},s==="availability"?"details":"pricing")]})]}),e.jsxs(h.Body,{className:O("flex h-full w-fit flex-col items-center divide-y overflow-hidden",{"mx-auto":s==="details"}),children:[e.jsx(u.Content,{value:"details",className:"h-full w-full",children:e.jsxs("div",{className:"container mx-auto w-[720px] px-1 py-8",children:[e.jsx(k,{level:"h2",className:"mb-12 mt-8 text-2xl",children:i("inventory.create.title")}),e.jsxs("div",{className:"flex flex-col gap-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-x-3 gap-y-6 lg:grid-cols-2",children:[e.jsx(t.Field,{control:l.control,name:"title",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{children:i("fields.title")}),e.jsx(t.Control,{children:e.jsx(o,{...r,placeholder:i("fields.title")})}),e.jsx(t.ErrorMessage,{})]})}),e.jsx(t.Field,{control:l.control,name:"sku",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{children:i("fields.sku")}),e.jsx(t.Control,{children:e.jsx(o,{...r,placeholder:"sku-123"})}),e.jsx(t.ErrorMessage,{})]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(t.Field,{control:l.control,name:"description",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.description.label")}),e.jsx(t.Control,{children:e.jsx(X,{...r,placeholder:"The item description"})})]})})}),e.jsx("div",{className:"col-span-2",children:e.jsx(t.Field,{control:l.control,name:"requires_shipping",render:({field:{value:r,onChange:f,...d}})=>e.jsxs(t.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t.Label,{children:i("inventory.create.requiresShipping")}),e.jsx(t.Control,{children:e.jsx(Y,{checked:r,onCheckedChange:a=>f(!!a),...d})})]}),e.jsx(t.Hint,{children:i("inventory.create.requiresShippingHint")})]}),e.jsx(t.ErrorMessage,{})]})})})]}),e.jsx(k,{level:"h3",className:"my-6",children:i("inventory.create.attributes")}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-8 lg:grid-cols-2",children:[e.jsx(t.Field,{control:l.control,name:"width",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.width.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r,type:"number",min:0,placeholder:"100"})})]})}),e.jsx(t.Field,{control:l.control,name:"length",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.length.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r,type:"number",min:0,placeholder:"100"})})]})}),e.jsx(t.Field,{control:l.control,name:"height",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.height.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r,type:"number",min:0,placeholder:"100"})})]})}),e.jsx(t.Field,{control:l.control,name:"weight",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.weight.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r,type:"number",min:0,placeholder:"100"})})]})}),e.jsx(t.Field,{control:l.control,name:"mid_code",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.mid_code.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r})})]})}),e.jsx(t.Field,{control:l.control,name:"hs_code",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.hs_code.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r})})]})}),e.jsx(t.Field,{control:l.control,name:"origin_country",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.countryOrigin.label")}),e.jsx(t.Control,{children:e.jsx(D,{...r})})]})}),e.jsx(t.Field,{control:l.control,name:"material",render:({field:r})=>e.jsxs(t.Item,{children:[e.jsx(t.Label,{optional:!0,children:i("products.fields.material.label")}),e.jsx(t.Control,{children:e.jsx(o,{...r})})]})})]})]})]})}),e.jsx(u.Content,{value:"availability",className:"h-full w-full",style:{width:"100vw"},children:e.jsx(ee,{form:l})})]})]})})})}function Ne(){return e.jsx(h,{children:e.jsx(ie,{})})}export{Ne as Component};
