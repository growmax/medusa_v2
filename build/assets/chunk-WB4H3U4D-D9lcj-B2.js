import{u as L,a as V,b as B}from"./chunk-NOAFLTPV-CWOM6qcu.js";import{u as I,j as e,r as x,bT as H}from"./index-7A3rjJyE.js";import{C as F}from"./chunk-ESMNJXW4-DaLuphnU.js";import{S as P}from"./chunk-6WYMDHSN-CdicKQQM.js";import{u as O,D as q}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import{b as M,F as l}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{z as p}from"./index-yuYasa5Y.js";import{B as v}from"./label-DDCdtDlT.js";import{C as T}from"./checkbox-BD385cy_.js";import{c as Q}from"./index-DL2eSRCZ.js";p.object({countries:p.array(p.object({iso_2:p.string().min(2),display_name:p.string()}))});var X=({form:o,onOpenChange:t})=>{const n=o,{t:r}=I(),{fields:d,remove:h,replace:g}=M({control:n.control,name:"countries",keyName:"iso_2"}),u=()=>{g([])};return z(o),e.jsx(l.Field,{control:o.control,name:"countries",render:()=>e.jsxs(l.Item,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-x-4",children:[e.jsxs("div",{children:[e.jsx(l.Label,{children:r("stockLocations.serviceZones.manageAreas.label")}),e.jsx(l.Hint,{children:r("stockLocations.serviceZones.manageAreas.hint")})]}),e.jsx(v,{size:"small",variant:"secondary",type:"button",onClick:()=>t(!0),children:r("stockLocations.serviceZones.manageAreas.action")})]}),e.jsx(l.ErrorMessage,{}),e.jsx(l.Control,{className:"mt-0",children:d.length>0&&e.jsx(F,{onClearAll:u,onRemove:h,className:"py-4",children:d.map((m,y)=>e.jsx(F.Chip,{index:y,children:m.display_name},m.iso_2))})})]})})},_="ac",C=50,J=({form:o,open:t,onOpenChange:n})=>{const r=o,{t:d}=I(),{getValues:h,setValue:g}=r,[u,m]=x.useState({}),[y,b]=x.useState([]),{searchParams:E,raw:R}=L({pageSize:C,prefix:_}),{countries:f,count:S}=V({countries:H.map(s=>({display_name:s.display_name,name:s.name,iso_2:s.iso_2,iso_3:s.iso_3,num_code:s.num_code})),...E});x.useEffect(()=>{if(!t)return;const s=h("countries");s&&(b(s.map(a=>({iso_2:a.iso_2,display_name:a.display_name}))),m(s.reduce((a,j)=>({...a,[j.iso_2]:!0}),{})))},[t,h]);const Z=s=>{const a=typeof s=="function"?s(u):s,j=Object.keys(a),k=new Set(j.filter(i=>a[i]&&!u[i])),A=[];if(k.size>0){const i=(f==null?void 0:f.filter(c=>k.has(c.iso_2)))??[];for(const c of i)A.push({iso_2:c.iso_2,display_name:c.display_name})}b(i=>{const c=i.filter(N=>a[N.iso_2]);return Array.from(new Set([...c,...A]))}),m(a)},D=()=>{g("countries",y,{shouldDirty:!0,shouldTouch:!0}),n(!1)},w=U(),{table:G}=O({data:f||[],columns:w,count:S,enablePagination:!0,enableRowSelection:!0,getRowId:s=>s.iso_2,pageSize:C,rowSelection:{state:u,updater:Z},prefix:_});return z(o),e.jsx(P.Drawer,{children:e.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[e.jsx(q,{table:G,columns:w,pageSize:C,count:S,search:!0,pagination:!0,layout:"fill",orderBy:["name","code"],queryObject:R,prefix:_}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2 border-t p-4",children:[e.jsx(P.Close,{type:"button",asChild:!0,children:e.jsx(v,{variant:"secondary",size:"small",children:d("actions.cancel")})}),e.jsx(v,{size:"small",type:"button",onClick:D,children:d("actions.add")})]})]})})},K=Q(),U=()=>{const o=B();return x.useMemo(()=>[K.display({id:"select",header:({table:t})=>e.jsx(T,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:n=>t.toggleAllPageRowsSelected(!!n)}),cell:({row:t})=>{const n=!t.getCanSelect();return e.jsx(T,{checked:t.getIsSelected()||n,disabled:n,onCheckedChange:r=>t.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}})}}),...o],[o])};function z(o){if(o.getValues("countries")===void 0)throw new Error("The form does not have a field named 'countries'. This field is required to use the GeoZoneForm component.")}var ie=Object.assign(X,{AreaDrawer:J});export{ie as G};
