import{P as _}from"./chunk-YRY2CZ6I-DlLYIuly.js";import{c as y,d as S}from"./chunk-DBDBBAQF-CuodlkG0.js";import{u as R,v as T,j as e,H as E,t as b,I as p}from"./index-7A3rjJyE.js";import{S as F}from"./chunk-ARXK2O3B-CKHwWM2L.js";import{a as t,u as v}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as w,F as s}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as I}from"./zod-DRKIF09R.js";import{z as i}from"./index-yuYasa5Y.js";import{B as g}from"./label-DDCdtDlT.js";import"./index.esm-L0DzsZPB.js";import"./switch-DDIyRuzh.js";import"./index-dBm6oMZZ.js";import"./prompt-KZNvJYzq.js";var N=i.object({name:i.string().min(1),code:i.string().optional(),rate:i.object({float:i.number().optional(),value:i.string().optional()}),is_combinable:i.boolean().optional()}),P=({taxRate:a,isSublevel:d=!1})=>{var u;const{t:r}=R(),{handleSuccess:l}=v(),n=w({defaultValues:{name:a.name,code:a.code||"",rate:{value:((u=a.rate)==null?void 0:u.toString())||""},is_combinable:a.is_combinable},resolver:I(N)}),{mutateAsync:m,isPending:x}=S(a.id),j=n.handleSubmit(async o=>{var c;await m({name:o.name,code:o.code||null,rate:(c=o.rate)==null?void 0:c.float,is_combinable:o.is_combinable},{onSuccess:()=>{b.success(r("taxRegions.taxRates.edit.successToast")),l()},onError:h=>{b.error(h.message)}})});return e.jsx(t.Form,{form:n,children:e.jsxs("form",{className:"flex flex-1 flex-col overflow-hidden",onSubmit:j,children:[e.jsxs(t.Body,{className:"flex flex-1 flex-col gap-y-6 overflow-auto",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:n.control,name:"name",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("fields.name")}),e.jsx(s.Control,{children:e.jsx(p,{...o})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:n.control,name:"code",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("taxRegions.fields.taxCode")}),e.jsx(s.Control,{children:e.jsx(p,{...o})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:n.control,name:"rate",render:({field:{value:o,onChange:c,...h}})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("taxRegions.fields.taxRate")}),e.jsx(s.Control,{children:e.jsx(_,{...h,value:o==null?void 0:o.value,onValueChange:(C,B,f)=>c({value:C,float:f==null?void 0:f.float})})}),e.jsx(s.ErrorMessage,{})]})})]}),d&&e.jsx(F,{control:n.control,name:"is_combinable",label:r("taxRegions.fields.isCombinable.label"),description:r("taxRegions.fields.isCombinable.hint")})]}),e.jsx(t.Footer,{className:"shrink-0",children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(t.Close,{asChild:!0,children:e.jsx(g,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(g,{size:"small",type:"submit",isLoading:x,children:r("actions.save")})]})})]})})},K=()=>{const{t:a}=R(),{province_id:d,tax_rate_id:r}=T(),{tax_rate:l,isPending:n,isError:m,error:x}=y(r),j=!n&&!!l;if(m)throw x;return e.jsxs(t,{children:[e.jsxs(t.Header,{children:[e.jsx(t.Title,{asChild:!0,children:e.jsx(E,{children:a("taxRegions.taxRates.edit.header")})}),e.jsx(t.Description,{className:"sr-only",children:a("taxRegions.taxRates.edit.hint")})]}),j&&e.jsx(P,{taxRate:l,isSublevel:!!d})]})};export{K as Component};
