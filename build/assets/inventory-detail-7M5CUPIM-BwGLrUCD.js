import{I as E}from"./chunk-LX4JNAOB-BJAKriRH.js";import{g as Q}from"./chunk-OIAPXGI2-CkBelqNL.js";import{S as d}from"./chunk-ULQT3HE4-DTXseesA.js";import{J as S}from"./chunk-3IW4HYUP-C89ww9p0.js";import{v as H,h as J,j as e,J as $,O as B,q,u as l,C as y,H as j,L as M,b as F,n as G,s as K,r as w,x as V,t as L}from"./index-7A3rjJyE.js";import{b as W,i as Y,e as Z,f as U}from"./chunk-DMYZ6SLX-BMyt3Z-P.js";import{a as X}from"./chunk-OIW3F4EQ-D8V0uZdG.js";import{u as ee,b as te}from"./chunk-KWVVOB4B-Bc14zBvB.js";import{T as se}from"./chunk-PHMALPVO-EKeNghx2.js";import{A as _}from"./chunk-WRXTMI2J-CygmDunM.js";import{u as T,D as P}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import{P as o}from"./chunk-P3UUX2T6-Bigsa15J.js";import{u as z}from"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{f as k}from"./format-CkWRMO1y.js";import{P as I}from"./pencil-square-mUSTT5rR.js";import{A as ae}from"./arrow-up-right-on-box-CF7GLQ-o.js";import{T as C}from"./trash-C_lucST6.js";import{u as D}from"./use-prompt-iL3FbEo4.js";import{B as A}from"./label-DDCdtDlT.js";import{c as O}from"./index-DL2eSRCZ.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./prompt-KZNvJYzq.js";var ie=({inventoryItem:s})=>{const{t}=l();return e.jsxs(y,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{level:"h2",children:t("products.attributes")}),e.jsx(_,{groups:[{actions:[{label:t("actions.edit"),to:"attributes",icon:e.jsx(I,{})}]}]})]}),e.jsx(d,{title:t("fields.height"),value:s.height}),e.jsx(d,{title:t("fields.width"),value:s.width}),e.jsx(d,{title:t("fields.length"),value:s.length}),e.jsx(d,{title:t("fields.weight"),value:s.weight}),e.jsx(d,{title:t("fields.midCode"),value:s.mid_code}),e.jsx(d,{title:t("fields.hsCode"),value:s.hs_code}),e.jsx(d,{title:t("fields.countryOfOrigin"),value:Q(s.origin_country)})]})},re=({pageSize:s=20,prefix:t})=>{const a=z(["id","location_id","stocked_quantity","reserved_quantity","incoming_quantity","available_quantity","*stock_locations"],t),{reserved_quantity:i,stocked_quantity:r,available_quantity:n,...c}=a;return{searchParams:{limit:s,reserved_quantity:i?JSON.parse(i):void 0,stocked_quantity:r?JSON.parse(r):void 0,available_quantity:n?JSON.parse(n):void 0,...c},raw:a}},ne=({level:s})=>{const{t}=l(),a=D(),{mutateAsync:i}=U(s.inventory_item_id,s.location_id),r=async()=>{await a({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await i()};return e.jsx(_,{groups:[{actions:[{icon:e.jsx(I,{}),label:t("actions.edit"),to:`locations/${s.location_id}`}]},{actions:[{icon:e.jsx(C,{}),label:t("actions.delete"),onClick:r}]}]})},v=O(),oe=()=>{const{t:s}=l();return w.useMemo(()=>[v.accessor("stock_locations.0.name",{header:s("fields.location"),cell:({getValue:t})=>{const a=t();return a?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a.toString()})}):e.jsx(o,{})}}),v.accessor("reserved_quantity",{header:s("inventory.reserved"),cell:({getValue:t})=>{const a=t();return Number.isNaN(a)?e.jsx(o,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a})})}}),v.accessor("stocked_quantity",{header:s("fields.inStock"),cell:({getValue:t})=>{const a=t();return Number.isNaN(a)?e.jsx(o,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a})})}}),v.accessor("available_quantity",{header:s("inventory.available"),cell:({getValue:t})=>{const a=t();return Number.isNaN(a)?e.jsx(o,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a})})}}),v.display({id:"actions",cell:({row:t})=>e.jsx(ne,{level:t.original})})],[s])},N=20,le=({inventory_item_id:s})=>{const{searchParams:t,raw:a}=re({pageSize:N}),{inventory_levels:i,count:r,isPending:n,isError:c,error:f}=Z(s,{...t,fields:"*stock_locations"}),u=oe(),{table:g}=T({data:i??[],columns:u,count:r,enablePagination:!0,getRowId:h=>h.id,pageSize:N});if(c)throw f;return e.jsx(P,{table:g,columns:u,pageSize:N,count:r,isLoading:n,pagination:!0,queryObject:a})},ce=({inventoryItem:s})=>{const{t}=l();return e.jsxs(y,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{children:t("inventory.locationLevels")}),e.jsx(A,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(M,{to:"locations",children:t("inventory.manageLocations")})})]}),e.jsx(le,{inventory_item_id:s.id})]})},de=({reservation:s})=>{const{t}=l(),a=D(),{mutateAsync:i}=te(s.id),r=async()=>{await a({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await i(void 0,{onSuccess:()=>{L.success(t("inventory.reservation.deleteSuccessToast"))},onError:c=>{L.error(c.message)}})};return e.jsx(_,{groups:[{actions:[{icon:e.jsx(I,{}),label:t("actions.edit"),to:`/reservations/${s.id}/edit`}]},{actions:[{icon:e.jsx(C,{}),label:t("actions.delete"),onClick:r}]}]})},me=({date:s})=>{if(!s)return e.jsx(o,{});const t=new Date(s);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const i=Intl.DateTimeFormat().resolvedOptions().hour12?"dd MMM yyyy hh:MM a":"dd MMM yyyy HH:MM";return e.jsx("div",{className:"flex h-full w-full items-center overflow-hidden",children:e.jsx(V,{className:"z-10",content:e.jsx("span",{className:"text-pretty",children:`${k(t,i)}`}),children:e.jsx("span",{className:"truncate",children:k(t,"dd MMM yyyy")})})})},m=O(),ue=({sku:s})=>{const{t}=l();return w.useMemo(()=>[m.display({header:t("fields.sku"),cell:()=>e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}),m.accessor("line_item.order_id",{header:t("inventory.reservation.orderID"),cell:({getValue:a})=>{const i=a();return i?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:i})}):e.jsx(o,{})}}),m.accessor("description",{header:t("fields.description"),cell:({getValue:a})=>{const i=a();return i?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:i})}):e.jsx(o,{})}}),m.accessor("location.name",{header:t("inventory.reservation.location"),cell:({getValue:a})=>{const i=a();return i?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:i})}):e.jsx(o,{})}}),m.accessor("created_at",{header:t("fields.createdAt"),cell:({getValue:a})=>e.jsx(me,{date:a()})}),m.display({id:"actions",cell:({row:a})=>e.jsx(de,{reservation:a.original})})],[t])},xe=({pageSize:s=20,prefix:t})=>{const a=z(["id","location_id","inventory_item_id","quantity","line_item_id","description","created_by"],t),{quantity:i,...r}=a;return{searchParams:{limit:s,quantity:i?JSON.parse(i):void 0,...r},raw:a}},b=20,pe=({inventoryItem:s})=>{const{searchParams:t,raw:a}=xe({pageSize:b}),{reservations:i,count:r,isPending:n,isError:c,error:f}=ee({...t,inventory_item_id:[s.id]}),{stock_locations:u}=X({id:(i||[]).map(x=>x.location_id)}),g=w.useMemo(()=>{const x=new Map((u||[]).map(p=>[p.id,p]));return(i||[]).map(p=>({...p,location:x.get(p.location_id)}))},[i,u]),h=ue({sku:s.sku}),{table:R}=T({data:g??[],columns:h,count:r,enablePagination:!0,getRowId:x=>x.id,pageSize:b});if(c)throw f;return e.jsx(P,{table:R,columns:h,pageSize:b,count:r,isLoading:n,pagination:!0,queryObject:a})},ve=({inventoryItem:s})=>{const{t}=l();return e.jsxs(y,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(j,{children:t("reservations.domain")}),e.jsx(A,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(M,{to:`/reservations/create?item_id=${s.id}`,children:t("actions.create")})})]}),e.jsx(pe,{inventoryItem:s})]})},fe=({variants:s})=>{const{t}=l(),a=F();return s!=null&&s.length?e.jsxs(y,{className:"p-0",children:[e.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:e.jsx(j,{level:"h2",children:t("inventory.associatedVariants")})}),e.jsx("div",{className:"txt-small flex flex-col gap-2 px-2 pb-2",children:s.map(i=>{var r;return e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-component rounded-md px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"shadow-elevation-card-rest rounded-md",children:e.jsx(se,{src:(r=i.product)==null?void 0:r.thumbnail})}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("span",{className:"text-ui-fg-base font-medium",children:i.title}),e.jsx("span",{className:"text-ui-fg-subtle",children:i.options.map(n=>n.value).join(" â‹… ")})]}),e.jsx(G,{size:"2xsmall",variant:"transparent",type:"button",onClick:()=>a(`/products/${i.product.id}/variants/${i.id}`),children:e.jsx(ae,{className:"text-ui-fg-muted"})})]})},i.id)})})]}):null},st=()=>{const{id:s}=H(),t=J(),{inventory_item:a,isPending:i,isError:r,error:n}=W(s,{fields:"*variants,*variants.product,*variants.options"},{initialData:t});if(i)return e.jsx("div",{children:"Loading..."});if(r||!a)throw n||$("An unknown error occurred",500);return e.jsx("div",{className:"flex flex-col gap-y-2",children:e.jsxs("div",{className:"flex flex-col gap-x-4 lg:flex-row lg:items-start",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-3",children:[e.jsx(E,{inventoryItem:a}),e.jsx(ce,{inventoryItem:a}),e.jsx(ve,{inventoryItem:a}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(S,{data:a})}),e.jsx(B,{})]}),e.jsxs("div",{className:"mt-2 flex w-full max-w-[100%] flex-col gap-y-2 lg:mt-0 lg:max-w-[400px]",children:[e.jsx(fe,{variants:a.variants}),e.jsx(ie,{inventoryItem:a}),e.jsx("div",{className:"lg:hidden",children:e.jsx(S,{data:a})})]})]})})},he=s=>({queryKey:Y.detail(s),queryFn:async()=>K.admin.inventoryItem.retrieve(s,{fields:"*variants,*variants.product,*variants.options"})}),at=async({params:s})=>{const t=s.id,a=he(t);return q.getQueryData(a.queryKey)??await q.fetchQuery(a)};export{st as Component,at as loader};
