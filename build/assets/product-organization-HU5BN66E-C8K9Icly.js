import{P as S}from"./chunk-SWMQZ55N-BUcYz0eG.js";import{C as V}from"./chunk-B4BZP35H-CLJOcDtQ.js";import{u as h}from"./chunk-KKUJQ3HN-BWZVkDDd.js";import{C as x}from"./chunk-UY4EBCIZ-D3QWhMGG.js";import{d as E,e as N}from"./chunk-YBHG7T6S-BleHOTgO.js";import{v as L,u as C,j as e,H as T,t as y,s as z,p as f}from"./index-7A3rjJyE.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{a as u,u as O}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as q,F as s}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as I}from"./zod-DRKIF09R.js";import{o as D,s as m,a as _}from"./index-yuYasa5Y.js";import{B as b}from"./label-DDCdtDlT.js";import"./chunk-MMJ4V5AR-M7tiWwVa.js";import"./x-mark-mini-Di7jARRp.js";import"./triangles-mini-JWkpofVU.js";import"./Trans-Cyi6soNY.js";import"./plus-mini-BHxdUq8n.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";var M=D({type_id:m().optional(),collection_id:m().optional(),category_ids:_(m()),tag_ids:_(m())}),R=({product:a})=>{var g,j;const{t:r}=C(),{handleSuccess:p}=O(),i=h({queryKey:["product_collections"],queryFn:o=>z.admin.productCollection.list(o),getOptions:o=>o.collections.map(t=>({label:t.title,value:t.id}))}),l=h({queryKey:["product_types"],queryFn:f.productTypes.list,getOptions:o=>o.product_types.map(t=>({label:t.value,value:t.id}))}),n=h({queryKey:["product_tags"],queryFn:f.productTags.list,getOptions:o=>o.product_tags.map(t=>({label:t.value,value:t.id}))}),c=q({defaultValues:{type_id:a.type_id||"",collection_id:a.collection_id||"",category_ids:((g=a.categories)==null?void 0:g.map(o=>o.id))||[],tag_ids:((j=a.tags)==null?void 0:j.map(o=>o.id))||[]},resolver:I(M)}),{mutateAsync:v,isPending:P}=N(a.id),F=c.handleSubmit(async o=>{var t;await v({type_id:o.type_id||void 0,collection_id:o.collection_id||void 0,categories:o.category_ids.map(d=>({id:d}))||void 0,tags:((t=o.tag_ids)==null?void 0:t.map(d=>{}))||void 0},{onSuccess:({product:d})=>{y.success(r("products.organization.edit.toasts.success",{title:d.title})),p()},onError:d=>{y.error(d.message)}})});return e.jsx(u.Form,{form:c,children:e.jsxs("form",{onSubmit:F,className:"flex h-full flex-col",children:[e.jsx(u.Body,{children:e.jsxs("div",{className:"flex h-full flex-col gap-y-4",children:[e.jsx(s.Field,{control:c.control,name:"type_id",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.type.label")}),e.jsx(s.Control,{children:e.jsx(x,{...o,options:l.options,searchValue:l.searchValue,onSearchValueChange:l.onSearchValueChange,fetchNextPage:l.fetchNextPage})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:c.control,name:"collection_id",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.collection.label")}),e.jsx(s.Control,{children:e.jsx(x,{...o,options:i.options,searchValue:i.searchValue,onSearchValueChange:i.onSearchValueChange,fetchNextPage:i.fetchNextPage})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:c.control,name:"category_ids",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.categories.label")}),e.jsx(s.Control,{children:e.jsx(V,{...o})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:c.control,name:"tag_ids",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.tags.label")}),e.jsx(s.Control,{children:e.jsx(x,{...o,multiple:!0,options:n.options,searchValue:n.searchValue,onSearchValueChange:n.onSearchValueChange,fetchNextPage:n.fetchNextPage})}),e.jsx(s.ErrorMessage,{})]})})]})}),e.jsx(u.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(u.Close,{asChild:!0,children:e.jsx(b,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(b,{size:"small",type:"submit",isLoading:P,children:r("actions.save")})]})})]})})},re=()=>{const{id:a}=L(),{t:r}=C(),{product:p,isLoading:i,isError:l,error:n}=E(a,{fields:S});if(l)throw n;return e.jsxs(u,{children:[e.jsx(u.Header,{children:e.jsx(T,{children:r("products.organization.edit.header")})}),!i&&p&&e.jsx(R,{product:p})]})};export{re as Component};
