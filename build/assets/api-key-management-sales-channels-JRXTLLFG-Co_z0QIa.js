import{d as K,h as k}from"./chunk-JVT2BXDL-CkNmt2FE.js";import{u as M,a as D}from"./chunk-NXJOVTDC-Cg50L4dD.js";import{v as E,j as e,u as x,r as C,t as S,x as z,k as B}from"./index-7A3rjJyE.js";import{u as H,D as I}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{a as F}from"./chunk-TQZNQHGA-CqGicYvo.js";import{R as c,u as L}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as N,H as O}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as V}from"./zod-DRKIF09R.js";import{o as q,a as G,s as Q}from"./index-yuYasa5Y.js";import{B as y}from"./label-DDCdtDlT.js";import{C as f}from"./checkbox-BD385cy_.js";import{c as Z}from"./index-DL2eSRCZ.js";import"./chunk-GA34GXNI-COeVOpas.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-IQRVIEMV-JX6w9umB.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./x-mark-mini-Di7jARRp.js";import"./chunk-YBHG7T6S-BleHOTgO.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var $=q({sales_channel_ids:G(Q())}),u=50,J=({apiKey:i,preSelected:t=[]})=>{const{t:s}=x(),{handleSuccess:o}=L(),r=N({defaultValues:{sales_channel_ids:[]},resolver:V($)}),{setValue:l}=r,[n,d]=C.useState({}),{mutateAsync:p,isPending:j}=k(i),{raw:_,searchParams:b}=M({pageSize:u}),h=W(),{sales_channels:T,count:g,isLoading:v}=F({...b},{placeholderData:B}),A=a=>{const m=typeof a=="function"?a(n):a,w=Object.keys(m);l("sales_channel_ids",w,{shouldDirty:!0,shouldTouch:!0}),d(m)},{table:R}=H({data:T??[],columns:h,count:g,enablePagination:!0,enableRowSelection:a=>!t.includes(a.original.id),getRowId:a=>a.id,pageSize:u,rowSelection:{state:n,updater:A}}),P=r.handleSubmit(async a=>{await p({sales_channel_ids:a.sales_channel_ids},{onSuccess:()=>{S.success(s("apiKeyManagement.salesChannels.successToast",{count:a.sales_channel_ids.length})),o()},onError:m=>{S.error(m.message)}})});return e.jsx(c.Form,{form:r,children:e.jsxs("form",{onSubmit:P,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(c.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[r.formState.errors.sales_channel_ids&&e.jsx(O,{variant:"error",children:r.formState.errors.sales_channel_ids.message}),e.jsx(c.Close,{asChild:!0,children:e.jsx(y,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(y,{size:"small",type:"submit",isLoading:j,children:s("actions.save")})]})}),e.jsx(c.Body,{children:e.jsx(I,{table:R,columns:h,count:g,pageSize:u,pagination:!0,search:!0,isLoading:v,queryObject:_,orderBy:["name","created_at","updated_at"],layout:"fill",noRecords:{message:s("apiKeyManagement.addSalesChannels.list.noRecordsMessage")}})})]})})},U=Z(),W=()=>{const{t:i}=x(),t=D();return C.useMemo(()=>[U.display({id:"select",header:({table:s})=>e.jsx(f,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:o=>s.toggleAllPageRowsSelected(!!o)}),cell:({row:s})=>{const o=!s.getCanSelect(),r=s.getIsSelected()||o,l=e.jsx(f,{checked:r,disabled:o,onCheckedChange:n=>s.toggleSelected(!!n),onClick:n=>{n.stopPropagation()}});return o?e.jsx(z,{content:i("apiKeyManagement.salesChannels.alreadyAddedTooltip"),side:"right",children:l}):l}}),...t],[i,t])},Ee=()=>{var d;const{id:i}=E(),{api_key:t,isLoading:s,isError:o,error:r}=K(i),l=(d=t==null?void 0:t.sales_channels)==null?void 0:d.map(p=>p.id),n=!s&&t;if(o)throw r;return e.jsx(c,{children:n&&e.jsx(J,{apiKey:i,preSelected:l})})};export{Ee as Component};
