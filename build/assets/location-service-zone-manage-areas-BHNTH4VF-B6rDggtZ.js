import{G as h}from"./chunk-WB4H3U4D-D9lcj-B2.js";import{v as S,J as y,j as e,u as w,r as C,bT as Z,t as j,H as b}from"./index-7A3rjJyE.js";import{c as z}from"./chunk-KUDWRWS3-C4McOvyT.js";import{u as A}from"./chunk-OIW3F4EQ-D8V0uZdG.js";import"./chunk-ESMNJXW4-DaLuphnU.js";import{S as v}from"./chunk-6WYMDHSN-CdicKQQM.js";import"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{R as l,u as E}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as F}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as L}from"./zod-DRKIF09R.js";import{z as m}from"./index-yuYasa5Y.js";import{B as g}from"./label-DDCdtDlT.js";import"./chunk-NOAFLTPV-CWOM6qcu.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./index-DL2eSRCZ.js";import"./checkbox-BD385cy_.js";import"./index-dBm6oMZZ.js";import"./chunk-MWKG2EGE-VcYUZG_Z.js";import"./x-mark-mini-Di7jARRp.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./prompt-KZNvJYzq.js";var N=m.object({countries:m.array(m.object({iso_2:m.string().min(2),display_name:m.string()})).min(1)});function O({fulfillmentSetId:i,locationId:d,zone:r}){const{t:o}=w(),{handleSuccess:p}=E(),[u,n]=C.useState(!1),s=F({defaultValues:{countries:r.geo_zones.map(c=>{const t=Z.find(_=>_.iso_2===c.country_code);return{iso_2:c.country_code,display_name:(t==null?void 0:t.display_name)||c.country_code.toUpperCase()}})},resolver:L(N)}),{mutateAsync:f,isPending:x}=z(i,r.id),a=s.handleSubmit(async c=>{await f({geo_zones:c.countries.map(({iso_2:t})=>({country_code:t,type:"country"}))},{onSuccess:()=>{j.success(o("stockLocations.serviceZones.manageAreas.successToast",{name:r.name})),p(`/settings/locations/${d}`)},onError:t=>{j.error(t.message)}})});return e.jsx(l.Form,{form:s,children:e.jsxs("form",{className:"flex h-full flex-col overflow-hidden",onSubmit:a,children:[e.jsx(l.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(l.Close,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"small",children:o("actions.cancel")})}),e.jsx(g,{type:"submit",size:"small",isLoading:x,children:o("actions.save")})]})}),e.jsx(l.Body,{className:"flex flex-col overflow-hidden",children:e.jsxs(v,{open:u,onOpenChange:n,children:[e.jsx(v.Content,{children:e.jsx("div",{className:"flex flex-col items-center p-16",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8",children:[e.jsx(b,{children:o("stockLocations.serviceZones.manageAreas.header",{name:r.name})}),e.jsx(h,{form:s,onOpenChange:n})]})})}),e.jsx(h.AreaDrawer,{form:s,open:u,onOpenChange:n})]})})]})})}var fe=()=>{var f,x;const{location_id:i,fset_id:d,zone_id:r}=S(),{stock_location:o,isPending:p,isError:u,error:n}=A(i,{fields:"*fulfillment_sets.service_zones.geo_zones"}),s=(x=(f=o==null?void 0:o.fulfillment_sets)==null?void 0:f.find(a=>a.id===d))==null?void 0:x.service_zones.find(a=>a.id===r);if(u)throw n;if(!p&&!s)throw y({message:`Service zone with ID ${r} was not found`},404);return e.jsx(l,{prev:`/settings/locations/${i}`,children:!p&&s&&e.jsx(O,{zone:s,fulfillmentSetId:d,locationId:i})})};export{fe as Component};
