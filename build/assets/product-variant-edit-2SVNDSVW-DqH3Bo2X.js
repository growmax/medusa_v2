import{p as D,a as g}from"./chunk-F63N33ZB-B4qPrixf.js";import{C as P}from"./chunk-FLW5D3SP-2BTcEG50.js";import{C as S}from"./chunk-UY4EBCIZ-D3QWhMGG.js";import{o as f}from"./chunk-Y2QXUTMB-CYOiJYmV.js";import{h as V,u as I,v as H,J as z,j as e,H as v,q as w,I as d,D as C,s as B}from"./index-7A3rjJyE.js";import{d as K,n as O,p as Q}from"./chunk-YBHG7T6S-BleHOTgO.js";import{a as m,u as R}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as $,F as r}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as A}from"./zod-DRKIF09R.js";import{z as i}from"./index-yuYasa5Y.js";import{S as F}from"./switch-DDIyRuzh.js";import{B as _}from"./label-DDCdtDlT.js";import"./chunk-6GU6IDUA-CDc7wW5L.js";import"./triangles-mini-JWkpofVU.js";import"./x-mark-mini-Di7jARRp.js";import"./plus-mini-BHxdUq8n.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var J=i.object({title:i.string().min(1),material:i.string().optional(),sku:i.string().optional(),ean:i.string().optional(),upc:i.string().optional(),barcode:i.string().optional(),manage_inventory:i.boolean(),allow_backorder:i.boolean(),weight:f,height:f,width:f,length:f,mid_code:i.string().optional(),hs_code:i.string().optional(),origin_country:i.string().optional(),options:i.record(i.string())}),T=({product:l,variant:o})=>{const{t:n}=I(),{handleSuccess:p}=R(),h=l.options.reduce((s,a)=>{const c=o.options.find(x=>x.option_id===a.id);return s[a.title]=c==null?void 0:c.value,s},{}),t=$({defaultValues:{title:o.title,material:o.material||"",sku:o.sku||"",ean:o.ean||"",upc:o.upc||"",barcode:o.barcode||"",inventory_quantity:o.inventory_quantity||"",manage_inventory:o.manage_inventory,allow_backorder:o.allow_backorder,weight:o.weight||"",height:o.height||"",width:o.width||"",length:o.length||"",mid_code:o.mid_code||"",hs_code:o.hs_code||"",origin_country:o.origin_country||"",options:h},resolver:A(J)}),{mutateAsync:y,isPending:b}=O(l.id,o.id),u=t.handleSubmit(async s=>{const{title:a,weight:c,height:x,width:j,length:L,allow_backorder:E,manage_inventory:k,options:M,...N}=s,q=D(N);await y({id:o.id,weight:g(c),height:g(x),width:g(j),length:g(L),title:a,allow_backorder:E,manage_inventory:k,options:M,...q},{onSuccess:()=>{p()}})});return e.jsx(m.Form,{form:t,children:e.jsxs("form",{onSubmit:u,className:"flex size-full flex-col overflow-hidden",children:[e.jsxs(m.Body,{className:"flex size-full flex-col gap-y-8 overflow-auto",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:t.control,name:"title",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:n("fields.title")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"material",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.material")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),l.options.map(s=>e.jsx(r.Field,{control:t.control,name:`options.${s.title}`,render:({field:{value:a,onChange:c,...x}})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:s.title}),e.jsx(r.Control,{children:e.jsx(S,{value:a,onChange:j=>{c(j)},...x,options:s.values.map(j=>({label:j.value,value:j.value}))})})]})},s.id))]}),e.jsx(C,{}),e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(v,{level:"h2",children:n("products.variant.inventory.header")}),e.jsx(r.Field,{control:t.control,name:"sku",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.sku")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"ean",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.ean")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"upc",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.upc")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"barcode",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.barcode")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(r.Field,{control:t.control,name:"manage_inventory",render:({field:{value:s,onChange:a,...c}})=>e.jsxs(r.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.Label,{children:n("products.variant.inventory.manageInventoryLabel")}),e.jsx(r.Control,{children:e.jsx(F,{checked:s,onCheckedChange:x=>a(!!x),...c})})]}),e.jsx(r.Hint,{children:n("products.variant.inventory.manageInventoryHint")})]}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"allow_backorder",render:({field:{value:s,onChange:a,...c}})=>e.jsxs(r.Item,{children:[e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r.Label,{children:n("products.variant.inventory.allowBackordersLabel")}),e.jsx(r.Control,{children:e.jsx(F,{checked:s,onCheckedChange:x=>a(!!x),...c})})]}),e.jsx(r.Hint,{children:n("products.variant.inventory.allowBackordersHint")})]}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsx(C,{}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(v,{level:"h2",children:n("products.attributes")}),e.jsx(r.Field,{control:t.control,name:"weight",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.weight")}),e.jsx(r.Control,{children:e.jsx(d,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"width",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.width")}),e.jsx(r.Control,{children:e.jsx(d,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"length",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.length")}),e.jsx(r.Control,{children:e.jsx(d,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"height",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.height")}),e.jsx(r.Control,{children:e.jsx(d,{type:"number",...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"mid_code",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.midCode")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"hs_code",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.hsCode")}),e.jsx(r.Control,{children:e.jsx(d,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:t.control,name:"origin_country",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{optional:!0,children:n("fields.countryOfOrigin")}),e.jsx(r.Control,{children:e.jsx(P,{...s})}),e.jsx(r.ErrorMessage,{})]})})]})]}),e.jsx(m.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(m.Close,{asChild:!0,children:e.jsx(_,{variant:"secondary",size:"small",children:n("actions.cancel")})}),e.jsx(_,{type:"submit",size:"small",isLoading:b,children:n("actions.save")})]})})]})})},pe=()=>{const l=V(),{t:o}=I(),{id:n,variant_id:p}=H(),{product:h,isLoading:t,isError:y,error:b}=K(n,void 0,{initialData:l}),u=h==null?void 0:h.variants.find(a=>a.id===p);if(!t&&!u)throw z({status:404,message:`Variant with ID ${p} was not found.`});const s=!t&&!!h&&!!u;if(y)throw b;return e.jsxs(m,{children:[e.jsx(m.Header,{children:e.jsx(v,{children:o("products.variant.edit.header")})}),s&&e.jsx(T,{product:h,variant:u})]})},U=l=>[Q.detail(l)],G=async l=>await B.admin.product.retrieve(l),W=l=>({queryKey:U(l),queryFn:async()=>G(l)}),ge=async({params:l})=>{const o=l.id,n=W(o);return w.getQueryData(n.queryKey)??await w.fetchQuery(n)};export{pe as Component,ge as loader};
