import{J as I}from"./chunk-3IW4HYUP-C89ww9p0.js";import{c as N,a as z,d as C,e as L}from"./chunk-7TY4Y7TY-B3QhHT0B.js";import{u as Q}from"./chunk-QBDU475K-BjRzsrqf.js";import{h as H,v as O,j as e,J as _,O as J,q as j,u as p,C as w,H as P,T as f,k as K,r as M,s as W,t as m}from"./index-7A3rjJyE.js";import{u as Y,a as $}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{A as g}from"./chunk-WRXTMI2J-CygmDunM.js";import{u as F,D as G}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as B}from"./chunk-YBHG7T6S-BleHOTgO.js";import{P as b}from"./pencil-square-mUSTT5rR.js";import{T as S}from"./trash-C_lucST6.js";import{P as U}from"./plus-o2nCfN-i.js";import{u as x}from"./use-prompt-iL3FbEo4.js";import{C as v}from"./checkbox-BD385cy_.js";import{c as V}from"./index-DL2eSRCZ.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-TQZNQHGA-CqGicYvo.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./label-DDCdtDlT.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";const Z={widgets:[]},X={widgets:[]};var ee=({collection:s})=>{const{t}=p(),o=x(),{mutateAsync:r}=z(s.id),a=async()=>{await o({title:t("general.areYouSure"),description:t("collections.deleteWarning",{count:1})})&&await r()};return e.jsxs(w,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(P,{children:s.title}),e.jsx(g,{groups:[{actions:[{icon:e.jsx(b,{}),label:t("actions.edit"),to:`/collections/${s.id}/edit`,disabled:!s.id}]},{actions:[{icon:e.jsx(S,{}),label:t("actions.delete"),onClick:a,disabled:!s.id}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(f,{size:"small",leading:"compact",weight:"plus",children:t("fields.handle")}),e.jsxs(f,{size:"small",children:["/",s.handle]})]})]})},d=10,te=({collection:s})=>{const{t}=p(),{searchParams:o,raw:r}=Y({pageSize:d}),{products:a,count:i,isLoading:c,isError:n,error:T}=B({limit:d,...o,collection_id:[s.id]},{placeholderData:K}),k=$(["collections"]),h=se(),{table:D}=F({data:a??[],columns:h,getRowId:l=>l.id,count:i,enablePagination:!0,enableRowSelection:!0,pageSize:d,meta:{collectionId:s.id}}),A=x(),{mutateAsync:R}=C(s.id),q=async l=>{const u=Object.keys(l);await A({title:t("general.areYouSure"),description:t("collections.removeProductsWarning",{count:u.length}),confirmText:t("actions.remove"),cancelText:t("actions.cancel")})&&await R({remove:u},{onSuccess:()=>{m.success(t("collections.products.remove.successToast",{count:u.length}))},onError:E=>{m.error(E.message)}})};if(n)throw T;return e.jsxs(w,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(P,{level:"h2",children:t("products.domain")}),e.jsx(g,{groups:[{actions:[{icon:e.jsx(U,{}),label:t("actions.add"),to:"products"}]}]})]}),e.jsx(G,{table:D,columns:h,search:!0,pagination:!0,pageSize:d,navigateTo:({original:l})=>`/products/${l.id}`,count:i,filters:k,isLoading:c,orderBy:["title","created_at","updated_at"],queryObject:r,commands:[{action:q,label:t("actions.remove"),shortcut:"r"}],noRecords:{message:t("collections.products.list.noRecordsMessage")}})]})},oe=({product:s,collectionId:t})=>{const{t:o}=p(),r=x(),{mutateAsync:a}=C(t),i=async()=>{await r({title:o("general.areYouSure"),description:o("collections.removeSingleProductWarning",{title:s.title}),confirmText:o("actions.remove"),cancelText:o("actions.cancel")})&&await a({remove:[s.id]},{onSuccess:()=>{m.success(o("collections.products.remove.successToast",{count:1}))},onError:n=>{m.error(n.message)}})};return e.jsx(g,{groups:[{actions:[{icon:e.jsx(b,{}),label:o("actions.edit"),to:`/products/${s.id}/edit`}]},{actions:[{icon:e.jsx(S,{}),label:o("actions.remove"),onClick:i}]}]})},y=V(),se=()=>{const s=Q();return M.useMemo(()=>[y.display({id:"select",header:({table:t})=>e.jsx(v,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:o=>t.toggleAllPageRowsSelected(!!o)}),cell:({row:t})=>e.jsx(v,{checked:t.getIsSelected(),onCheckedChange:o=>t.toggleSelected(!!o),onClick:o=>{o.stopPropagation()}})}),...s,y.display({id:"actions",cell:({row:t,table:o})=>{const{collectionId:r}=o.options.meta;return e.jsx(oe,{product:t.original,collectionId:r})}})],[s])},Ue=()=>{const s=H(),{id:t}=O(),{collection:o,isLoading:r,isError:a,error:i}=N(t,{initialData:s});if(r)return e.jsx("div",{children:"Loading..."});if(a||!o)throw i||_("An unknown error occurred",500);return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[X.widgets.map((c,n)=>e.jsx("div",{children:e.jsx(c.Component,{data:o})},n)),e.jsx(ee,{collection:o}),e.jsx(te,{collection:o}),Z.widgets.map((c,n)=>e.jsx("div",{children:e.jsx(c.Component,{data:o})},n)),e.jsx(I,{data:o}),e.jsx(J,{})]})},re=s=>({queryKey:L.detail(s),queryFn:async()=>W.admin.productCollection.retrieve(s)}),Ve=async({params:s})=>{const t=s.id,o=re(t);return j.getQueryData(o.queryKey)??await j.fetchQuery(o)};export{Ue as Component,Ve as loader};
