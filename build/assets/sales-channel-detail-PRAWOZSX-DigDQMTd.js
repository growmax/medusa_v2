import{J as L}from"./chunk-3IW4HYUP-C89ww9p0.js";import{u as N}from"./chunk-QBDU475K-BjRzsrqf.js";import{q as h,h as z,v as Q,j as e,O as $,p as B,u as p,b as H,C as v,H as y,T as x,r as S,k as O,L as K,t as l}from"./index-7A3rjJyE.js";import{u as M,a as F}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{A as C}from"./chunk-WRXTMI2J-CygmDunM.js";import{u as G,D as J}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as W,b as Y,d as b}from"./chunk-TQZNQHGA-CqGicYvo.js";import{p as V,u as Z}from"./chunk-YBHG7T6S-BleHOTgO.js";import{P as w}from"./pencil-square-mUSTT5rR.js";import{T as P}from"./trash-C_lucST6.js";import{u as T}from"./use-prompt-iL3FbEo4.js";import{S as U}from"./status-badge-BK5p0WUV.js";import{B as X}from"./label-DDCdtDlT.js";import{C as f}from"./checkbox-BD385cy_.js";import{c as ee}from"./index-DL2eSRCZ.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";const se={widgets:[]},te={widgets:[]};var ae=t=>({queryKey:V.detail(t),queryFn:async()=>B.salesChannels.retrieve(t)}),Ue=async({params:t})=>{const s=t.id,a=ae(s);return h.getQueryData(a.queryKey)??await h.fetchQuery(a)},re=({salesChannel:t})=>{const{t:s}=p(),a=T(),r=H(),{mutateAsync:o}=Y(t.id),n=async()=>{await a({title:s("general.areYouSure"),description:s("salesChannels.deleteSalesChannelWarning",{name:t.name}),verificationInstruction:s("general.typeToConfirm"),verificationText:t.name,confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&await o(void 0,{onSuccess:()=>{l.success(s("salesChannels.toast.delete")),r("/settings/sales-channels",{replace:!0})},onError:m=>{l.error(m.message)}})};return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{children:t.name}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(U,{color:t.is_disabled?"red":"green",children:s(`general.${t.is_disabled?"disabled":"enabled"}`)}),e.jsx(C,{groups:[{actions:[{icon:e.jsx(w,{}),label:s("actions.edit"),to:`/settings/sales-channels/${t.id}/edit`}]},{actions:[{icon:e.jsx(P,{}),label:s("actions.delete"),onClick:n}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(x,{size:"small",leading:"compact",weight:"plus",children:s("fields.description")}),e.jsx(x,{size:"small",leading:"compact",children:t.description||"-"})]})]})},u=10,oe=({salesChannel:t})=>{const[s,a]=S.useState({}),{searchParams:r,raw:o}=M({pageSize:u}),{products:n,count:d,isPending:m,isError:_,error:k}=Z({...r,sales_channel_id:[t.id]},{placeholderData:O}),g=ne(),D=F(["sales_channel_id"]),{table:R}=G({data:n??[],columns:g,count:d,enablePagination:!0,enableRowSelection:!0,pageSize:u,getRowId:c=>c.id,rowSelection:{state:s,updater:a},meta:{salesChannelId:t.id}}),{mutateAsync:A}=b(t.id),q=T(),{t:i}=p(),E=async()=>{const c=Object.keys(s);await q({title:i("general.areYouSure"),description:i("salesChannels.removeProductsWarning",{count:c.length,sales_channel:t.name}),confirmText:i("actions.delete"),cancelText:i("actions.cancel")})&&await A({product_ids:c},{onSuccess:()=>{l.success(i("salesChannels.toast.update")),a({})},onError:I=>{l.error(I.message)}})};if(_)throw k;return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{level:"h2",children:i("products.domain")}),e.jsx(K,{to:`/settings/sales-channels/${t.id}/add-products`,children:e.jsx(X,{size:"small",variant:"secondary",children:i("general.add")})})]}),e.jsx(J,{table:R,columns:g,pageSize:u,commands:[{action:E,label:i("actions.remove"),shortcut:"r"}],count:d,pagination:!0,search:!0,filters:D,navigateTo:c=>`/products/${c.id}`,isLoading:m,orderBy:["title","variants","status","created_at","updated_at"],queryObject:o,noRecords:{message:i("salesChannels.products.list.noRecordsMessage")}})]})},j=ee(),ne=()=>{const t=N();return S.useMemo(()=>[j.display({id:"select",header:({table:s})=>e.jsx(f,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a)}),cell:({row:s})=>e.jsx(f,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),onClick:a=>{a.stopPropagation()}})}),...t,j.display({id:"actions",cell:({row:s,table:a})=>{const{salesChannelId:r}=a.options.meta;return e.jsx(ie,{productId:s.original.id,salesChannelId:r})}})],[t])},ie=({salesChannelId:t,productId:s})=>{const{t:a}=p(),{mutateAsync:r}=b(t),o=async()=>{await r({product_ids:[s]},{onSuccess:()=>{l.success(a("salesChannels.toast.update"))},onError:n=>{l.error(n.message)}})};return e.jsx(C,{groups:[{actions:[{icon:e.jsx(w,{}),label:a("actions.edit"),to:`/products/${s}`}]},{actions:[{icon:e.jsx(P,{}),label:a("actions.remove"),onClick:o}]}]})},Xe=()=>{const t=z(),{id:s}=Q(),{sales_channel:a,isPending:r}=W(s,{initialData:t});return r||!a?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"flex flex-col gap-y-2",children:[te.widgets.map((o,n)=>e.jsx("div",{children:e.jsx(o.Component,{data:a})},n)),e.jsx(re,{salesChannel:a}),e.jsx(oe,{salesChannel:a}),se.widgets.map((o,n)=>e.jsx("div",{children:e.jsx(o.Component,{data:a})},n)),e.jsx(L,{data:a}),e.jsx($,{})]})};export{Xe as Component,Ue as loader};
