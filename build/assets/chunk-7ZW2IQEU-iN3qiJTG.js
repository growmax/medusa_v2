import{C as y}from"./chunk-DP6F32JR-9J2iiaFb.js";import{u as f,c9 as _,r as C,j as e,T as i,H as v}from"./index-7A3rjJyE.js";import{u as F,a as g}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as w,a as j,F as r}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as S}from"./zod-DRKIF09R.js";import{o as T,s as B,e as E}from"./index-yuYasa5Y.js";import{T as V}from"./Trans-Cyi6soNY.js";import{B as b}from"./label-DDCdtDlT.js";import{R as u}from"./radio-group-C5P_IsHK.js";import{S as p}from"./select-cXhfXDq8.js";var P=({campaign:s})=>{var o,l,t,n,d,c;const{t:a}=f();if(s)return e.jsxs(C.Fragment,{children:[e.jsxs("div",{children:[e.jsx(v,{level:"h2",className:"mb-4",children:a("campaigns.details")}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus font-",children:a("campaigns.fields.identifier")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:s.campaign_identifier||"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus",children:a("fields.description")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:s.description||"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus",children:a("campaigns.fields.start_date")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:((o=s.starts_at)==null?void 0:o.toString())||"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus",children:a("campaigns.fields.end_date")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:((l=s.ends_at)==null?void 0:l.toString())||"-"})})]})]}),e.jsxs("div",{children:[e.jsx(v,{level:"h2",className:"mb-4",children:a("campaigns.budget.details")}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus font-",children:a("campaigns.budget.fields.type")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:((t=s.budget)==null?void 0:t.type)||"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus",children:a("campaigns.budget.fields.currency")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:((n=s==null?void 0:s.budget)==null?void 0:n.currency_code)||"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus",children:a("campaigns.budget.fields.limit")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:((d=s.budget)==null?void 0:d.limit)||"-"})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center py-1",children:[e.jsx(i,{className:"txt-small-plus",children:a("campaigns.budget.fields.used")}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(i,{className:"txt-small",children:((c=s.budget)==null?void 0:c.used)||"-"})})]})]})]})},R=T({campaign_id:B().optional().nullable(),campaign_choice:E(["none","existing"]).optional()}),A=({form:s,campaigns:a,withNewCampaign:o=!0})=>{const{t:l}=f(),t=j({control:s.control,name:"campaign_id"}),n=j({control:s.control,name:"campaign_choice"}),d=a.find(c=>c.id===t);return e.jsxs("div",{className:"flex h-full flex-col gap-y-8",children:[e.jsx(r.Field,{control:s.control,name:"campaign_choice",render:({field:c})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:l("promotions.fields.campaign")}),e.jsx(r.Control,{children:e.jsxs(u,{className:"flex gap-y-3",...c,value:c.value,onValueChange:c.onChange,children:[e.jsx(u.ChoiceBox,{value:"none",label:l("promotions.form.campaign.none.title"),description:l("promotions.form.campaign.none.description")}),e.jsx(u.ChoiceBox,{value:"existing",label:l("promotions.form.campaign.existing.title"),description:l("promotions.form.campaign.existing.description")}),o&&e.jsx(u.ChoiceBox,{value:"new",label:l("promotions.form.campaign.new.title"),description:l("promotions.form.campaign.new.description")})]})}),e.jsx(r.ErrorMessage,{})]})}),n==="existing"&&e.jsx(r.Field,{control:s.control,name:"campaign_id",render:({field:{onChange:c,ref:h,...m}})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:l("promotions.form.campaign.existing.title")}),e.jsx(r.Control,{children:e.jsxs(p,{onValueChange:c,...m,children:[e.jsx(p.Trigger,{ref:h,children:e.jsx(p.Value,{})}),e.jsx(p.Content,{children:a.map(x=>{var N;return e.jsx(p.Item,{value:x.id,children:(N=x.name)==null?void 0:N.toUpperCase()},x.id)})})]})}),e.jsx(i,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:e.jsx(V,{t:l,i18nKey:"campaigns.fields.campaign_id.hint",components:[e.jsx("br",{},"break")]})}),e.jsx(r.ErrorMessage,{})]})}),n==="new"&&e.jsx(y,{form:s,fieldScope:"campaign."}),e.jsx(P,{campaign:d})]})},W=({promotion:s,campaigns:a})=>{const{t:o}=f(),{handleSuccess:l}=F(),{campaign:t}=s,n=w({defaultValues:{campaign_id:t==null?void 0:t.id,campaign_choice:t!=null&&t.id?"existing":"none"},resolver:S(R)}),{mutateAsync:d,isPending:c}=_(s.id),h=n.handleSubmit(async x=>{await d({campaign_id:x.campaign_id},{onSuccess:()=>l()})}),m=j({control:n.control,name:"campaign_choice"});return C.useEffect(()=>{m==="none"&&n.setValue("campaign_id",null),m==="existing"&&n.setValue("campaign_id",t==null?void 0:t.id)},[m]),e.jsx(g.Form,{form:n,children:e.jsxs("form",{onSubmit:h,className:"flex h-full flex-col",children:[e.jsx(g.Body,{children:e.jsx(A,{form:n,campaigns:a,withNewCampaign:!1})}),e.jsx(g.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(g.Close,{asChild:!0,children:e.jsx(b,{size:"small",variant:"secondary",children:o("actions.cancel")})}),e.jsx(b,{size:"small",type:"submit",isLoading:c,children:o("actions.save")})]})})]})})};export{A,W as a};
