import{P as R}from"./chunk-YRY2CZ6I-DlLYIuly.js";import{b as C}from"./chunk-DBDBBAQF-CuodlkG0.js";import{v,cH as T,j as e,u as _,t as h,H as y,T as F,I as u}from"./index-7A3rjJyE.js";import{S}from"./chunk-ARXK2O3B-CKHwWM2L.js";import{R as i,u as w}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as N,F as s}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as E}from"./zod-DRKIF09R.js";import{z as t}from"./index-yuYasa5Y.js";import{B as g}from"./label-DDCdtDlT.js";import"./index.esm-L0DzsZPB.js";import"./switch-DDIyRuzh.js";import"./index-dBm6oMZZ.js";import"./prompt-KZNvJYzq.js";var I=t.object({name:t.string().min(1),code:t.string().optional(),rate:t.object({float:t.number().optional(),value:t.string().optional()}).optional(),is_combinable:t.boolean().optional()}),M=({taxRegion:c,isSublevel:n=!1})=>{const{t:o}=_(),{handleSuccess:x}=w(),r=N({defaultValues:{name:"",code:"",rate:{value:""},is_combinable:!1},resolver:E(I)}),{mutateAsync:d,isPending:m}=C(),p=r.handleSubmit(async a=>{var l;await d({tax_region_id:c.id,is_default:!0,name:a.name,code:a.code||void 0,rate:(l=a.rate)==null?void 0:l.float,is_combinable:a.is_combinable},{onSuccess:()=>{h.success(o("taxRegions.taxRates.create.successToast")),x()},onError:f=>{h.error(f.message)}})});return e.jsx(i.Form,{form:r,children:e.jsxs("form",{onSubmit:p,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(i.Header,{}),e.jsx(i.Body,{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[e.jsxs("div",{children:[e.jsx(y,{children:o("taxRegions.taxRates.create.header")}),e.jsx(F,{size:"small",className:"text-ui-fg-subtle",children:o("taxRegions.taxRates.create.hint")})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(s.Field,{control:r.control,name:"name",render:({field:a})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:o("fields.name")}),e.jsx(s.Control,{children:e.jsx(u,{...a})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:r.control,name:"rate",render:({field:{value:a,onChange:l,...f}})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:o("taxRegions.fields.taxRate")}),e.jsx(s.Control,{children:e.jsx(R,{...f,value:a==null?void 0:a.value,onValueChange:(b,P,j)=>l({value:b,float:j==null?void 0:j.float})})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:r.control,name:"code",render:({field:a})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:o("taxRegions.fields.taxCode")}),e.jsx(s.Control,{children:e.jsx(u,{...a})}),e.jsx(s.ErrorMessage,{})]})})]}),n&&e.jsx(S,{control:r.control,name:"is_combinable",label:o("taxRegions.fields.isCombinable.label"),description:o("taxRegions.fields.isCombinable.hint")})]})})}),e.jsx(i.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(i.Close,{asChild:!0,children:e.jsx(g,{size:"small",variant:"secondary",children:o("actions.cancel")})}),e.jsx(g,{size:"small",type:"submit",isLoading:m,children:o("actions.save")})]})})]})})},O=()=>{const{id:c,province_id:n}=v(),{tax_region:o,isPending:x,isError:r,error:d}=T(n||c),m=!x&&!!o;if(r)throw d;return e.jsx(i,{children:m&&e.jsx(M,{taxRegion:o,isSublevel:!!n})})};export{O as Component};
