import{u as I}from"./chunk-QBDU475K-BjRzsrqf.js";import{v as z,j as e,u as y,r as P,k as D,t as x,x as F}from"./index-7A3rjJyE.js";import{u as H,a as B}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{u as M,D as L}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as N,f as O}from"./chunk-TQZNQHGA-CqGicYvo.js";import{u as V}from"./chunk-YBHG7T6S-BleHOTgO.js";import{R as u,u as q}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as G,H as Q}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as Z}from"./zod-DRKIF09R.js";import{o as $,a as J,s as K}from"./index-yuYasa5Y.js";import{B as C}from"./label-DDCdtDlT.js";import{C as j}from"./checkbox-BD385cy_.js";import{c as U}from"./index-DL2eSRCZ.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./x-mark-mini-Di7jARRp.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var W=$({product_ids:J(K()).min(1)}),f=50,X=({salesChannel:a})=>{const{t:o}=y(),{handleSuccess:s}=q(),t=G({defaultValues:{product_ids:[]},resolver:Z(W)}),{setValue:l}=t,{mutateAsync:c,isPending:p}=O(a.id),[d,m]=P.useState({}),i=r=>{const n=typeof r=="function"?r(d):r,h=Object.keys(n);l("product_ids",h,{shouldDirty:!0,shouldTouch:!0}),m(n)},{searchParams:b,raw:v}=H({pageSize:f}),{products:_,count:g,isPending:T,isError:w,error:R}=V({fields:"*variants,*sales_channels",...b},{placeholderData:D}),S=ee(),A=B(["sales_channel_id"]),{table:k}=M({data:_??[],columns:S,enableRowSelection:r=>{var n;return!((n=r.original.sales_channels)!=null&&n.map(h=>h.id).includes(a.id))},enablePagination:!0,getRowId:r=>r.id,pageSize:f,count:g,rowSelection:{state:d,updater:i},meta:{salesChannelId:a.id}}),E=t.handleSubmit(async r=>{await c({product_ids:r.product_ids},{onSuccess:()=>{x.success(o("salesChannels.toast.update")),s()},onError:n=>x.error(n.message)})});if(w)throw R;return e.jsx(u.Form,{form:t,children:e.jsxs("form",{onSubmit:E,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(u.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t.formState.errors.product_ids&&e.jsx(Q,{variant:"error",children:t.formState.errors.product_ids.message}),e.jsx(u.Close,{asChild:!0,children:e.jsx(C,{size:"small",variant:"secondary",children:o("actions.cancel")})}),e.jsx(C,{size:"small",type:"submit",isLoading:p,children:o("actions.save")})]})}),e.jsx(u.Body,{className:"flex size-full flex-col overflow-y-auto",children:e.jsx(L,{table:k,count:g,columns:S,pageSize:f,isLoading:T,filters:A,orderBy:["title","status","created_at","updated_at"],queryObject:v,layout:"fill",pagination:!0,search:!0,noRecords:{message:o("salesChannels.products.add.list.noRecordsMessage")}})})]})})},Y=U(),ee=()=>{const a=I(),{t:o}=y();return P.useMemo(()=>[Y.display({id:"select",header:({table:s})=>e.jsx(j,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t)}),cell:({row:s,table:t})=>{var m;const{salesChannelId:l}=t.options.meta,c=(m=s.original.sales_channels)==null?void 0:m.map(i=>i.id).includes(l),p=s.getIsSelected()||c,d=e.jsx(j,{checked:p,disabled:c,onCheckedChange:i=>s.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}});return c?e.jsx(F,{content:o("salesChannels.productAlreadyAdded"),side:"right",children:d}):d}}),...a],[o,a])},Me=()=>{const{id:a}=z(),{sales_channel:o,isPending:s,isError:t,error:l}=N(a);if(t)throw l;return e.jsx(u,{children:!s&&o&&e.jsx(X,{salesChannel:o})})};export{Me as Component};
