import{i as y,a as I}from"./chunk-R2O6QX4D-CX21ziz_.js";import{I as B}from"./chunk-EQTBJSBZ-b_1V6fJN.js";import{L as R}from"./chunk-I3VB6NM2-KfRd9ms0.js";import{L as E}from"./chunk-6WKBBTKM-C1QI-Gio.js";import{f as J}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{a as W}from"./chunk-OIAPXGI2-CkBelqNL.js";import{J as P}from"./chunk-3IW4HYUP-C89ww9p0.js";import{u as U,a as X}from"./chunk-KUDWRWS3-C4McOvyT.js";import{a as ee}from"./chunk-MWKG2EGE-VcYUZG_Z.js";import{u as se,s as te,d as ne,b as ie}from"./chunk-OIW3F4EQ-D8V0uZdG.js";import{r as d,q as T,h as ae,v as oe,j as e,O as re,s as ce,ct as le,C,H as S,T as x,u as h,b as de,bT as pe,n as me,t as m,D,B as fe,K as ue}from"./index-7A3rjJyE.js";import{A as j}from"./chunk-WRXTMI2J-CygmDunM.js";import{N as q}from"./chunk-WX2SMNCD-D4nWbVrW.js";import{a as xe}from"./chunk-TQZNQHGA-CqGicYvo.js";import{P as A}from"./plus-o2nCfN-i.js";import{T as b}from"./trash-C_lucST6.js";import{P as N}from"./pencil-square-mUSTT5rR.js";import{T as he}from"./triangle-down-mini-BHNqpDM0.js";import{C as ge}from"./channels-D53LzY8a.js";import{u as k}from"./use-prompt-iL3FbEo4.js";import{S as ve}from"./status-badge-BK5p0WUV.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./square-two-stack-Ao9P_yLE.js";import"./plus-mini-BHxdUq8n.js";import"./label-DDCdtDlT.js";import"./chunk-YBHG7T6S-BleHOTgO.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";var je=Object.defineProperty,_=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,M=(s,n,t)=>n in s?je(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,ye=(s,n)=>{for(var t in n||(n={}))H.call(n,t)&&M(s,t,n[t]);if(_)for(var t of _(n))V.call(n,t)&&M(s,t,n[t]);return s},_e=(s,n)=>{var t={};for(var i in s)H.call(s,i)&&n.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&_)for(var i of _(s))n.indexOf(i)<0&&V.call(s,i)&&(t[i]=s[i]);return t};const K=d.forwardRef((s,n)=>{var t=s,{color:i="currentColor"}=t,o=_e(t,["color"]);return d.createElement("svg",ye({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},o),d.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},d.createElement("path",{d:"M12.611 5.056v6.222c0 .982-.795 1.778-1.778 1.778H4.167a1.777 1.777 0 0 1-1.778-1.778V5.056M13.056 1.944H1.944a.89.89 0 0 0-.888.89v1.333c0 .49.398.888.888.888h11.112a.89.89 0 0 0 .888-.888V2.833a.89.89 0 0 0-.889-.889M5.722 7.722h3.556"})),d.createElement("defs",null,d.createElement("clipPath",{id:"a"},d.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});K.displayName="ArchiveBox";var we=Object.defineProperty,w=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,z=(s,n,t)=>n in s?we(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,be=(s,n)=>{for(var t in n||(n={}))Q.call(n,t)&&z(s,t,n[t]);if(w)for(var t of w(n))Y.call(n,t)&&z(s,t,n[t]);return s},Ne=(s,n)=>{var t={};for(var i in s)Q.call(s,i)&&n.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&w)for(var i of w(s))n.indexOf(i)<0&&Y.call(s,i)&&(t[i]=s[i]);return t};const $=d.forwardRef((s,n)=>{var t=s,{color:i="currentColor"}=t,o=Ne(t,["color"]);return d.createElement("svg",be({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},o),d.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},d.createElement("path",{d:"M5.056 1.982v9.333M9.944 3.685v9.333M1.752 2.679 4.802 2a.9.9 0 0 1 .497.032l4.402 1.601c.159.058.331.07.497.032l2.665-.592a.888.888 0 0 1 1.081.868v7.513c0 .417-.29.778-.696.867l-3.05.679a.9.9 0 0 1-.497-.032l-4.402-1.601a.9.9 0 0 0-.497-.032l-2.665.592a.89.89 0 0 1-1.081-.868V3.546c0-.417.29-.778.696-.867"})),d.createElement("defs",null,d.createElement("clipPath",{id:"a"},d.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});$.displayName="Map";const ke={widgets:[]},Le={widgets:[]},Oe={widgets:[]},$e={widgets:[]};var G="name,*sales_channels,*address,fulfillment_sets.type,fulfillment_sets.name,*fulfillment_sets.service_zones.geo_zones,*fulfillment_sets.service_zones,*fulfillment_sets.service_zones.shipping_options,*fulfillment_sets.service_zones.shipping_options.rules,*fulfillment_sets.service_zones.shipping_options.shipping_profile",Ce=s=>({queryKey:te.detail(s),queryFn:async()=>await ce.admin.stockLocation.retrieve(s,{fields:G}).catch(n=>{throw n.status===401?le("/login"):n})}),ms=async({params:s})=>{const n=s.location_id,t=Ce(n);return T.getQueryData(t.queryKey)??await T.fetchQuery(t)},Se=({location:s})=>{var n,t;return e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"p-0",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:s.name}),e.jsx(x,{className:"text-ui-fg-subtle txt-small",children:W({address:s.address}).join(", ")})]}),e.jsx(Te,{location:s})]})}),e.jsx(F,{locationId:s.id,locationName:s.name,type:"pickup",fulfillmentSet:(n=s.fulfillment_sets)==null?void 0:n.find(i=>i.type==="pickup")}),e.jsx(F,{locationId:s.id,locationName:s.name,type:"shipping",fulfillmentSet:(t=s.fulfillment_sets)==null?void 0:t.find(i=>i.type==="shipping")})]})};function Z({option:s,fulfillmentSetId:n,locationId:t}){const i=k(),{t:o}=h(),r=I(s),{mutateAsync:a}=ee(s.id),c=async()=>{await i({title:o("general.areYouSure"),description:o("stockLocations.shippingOptions.delete.confirmation",{name:s.name}),verificationInstruction:o("general.typeToConfirm"),verificationText:s.name,confirmText:o("actions.delete"),cancelText:o("actions.cancel")})&&await a(void 0,{onSuccess:()=>{m.success(o("stockLocations.shippingOptions.delete.successToast",{name:s.name}))},onError:v=>{m.error(v.message)}})};return e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(x,{size:"small",weight:"plus",children:[s.name," - ",s.shipping_profile.name," (",J(s.provider_id),")"]})}),e.jsx(fe,{className:"mr-4",color:r?"grey":"purple",size:"2xsmall",rounded:"full",children:o(r?"general.store":"general.admin")}),e.jsx(j,{groups:[{actions:[{icon:e.jsx(N,{}),label:o("stockLocations.shippingOptions.edit.action"),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${s.service_zone_id}/shipping-option/${s.id}/edit`},{label:o("stockLocations.shippingOptions.pricing.action"),icon:e.jsx(ue,{}),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${s.service_zone_id}/shipping-option/${s.id}/pricing`}]},{actions:[{label:o("actions.delete"),icon:e.jsx(b,{}),onClick:c}]}]})]})}function Ee({zone:s,locationId:n,fulfillmentSetId:t}){const{t:i}=h(),o=s.shipping_options.filter(a=>!y(a)),r=s.shipping_options.filter(a=>y(a));return e.jsxs("div",{children:[e.jsx(D,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"item-center flex justify-between",children:[e.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.shipping.label")}),e.jsx(E,{to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/shipping-option/create`,children:i("stockLocations.shippingOptions.create.action")})]}),!!o.length&&e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:o.map(a=>e.jsx(Z,{option:a,locationId:n,fulfillmentSetId:t},a.id))})]}),e.jsx(D,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"item-center flex justify-between",children:[e.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.returns.label")}),e.jsx(E,{to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/shipping-option/create?is_return`,children:i("stockLocations.shippingOptions.create.action")})]}),!!r.length&&e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:r.map(a=>e.jsx(Z,{option:a,locationId:n,fulfillmentSetId:t},a.id))})]})]})}function Pe({zone:s,locationId:n,fulfillmentSetId:t}){const{t:i}=h(),o=k(),[r,a]=d.useState(!0),{mutateAsync:c}=X(t,s.id),g=async()=>{await o({title:i("general.areYouSure"),description:i("stockLocations.serviceZones.delete.confirmation",{name:s.name}),confirmText:i("actions.delete"),cancelText:i("actions.cancel")})&&await c(void 0,{onError:f=>{m.error(f.message)},onSuccess:()=>{m.success(i("stockLocations.serviceZones.delete.successToast",{name:s.name}))}})},v=d.useMemo(()=>{const p=s.geo_zones.filter(l=>l.type==="country"),f=p.map(({country_code:l})=>pe.find(u=>u.iso_2===l)).filter(l=>!!l);return p.length!==f.length&&console.warn("Some countries are missing in the static countries list",p.filter(l=>!f.find(u=>u.iso_2===l.country_code)).map(l=>l.country_code)),f.sort((l,u)=>l.name.localeCompare(u.name))},[s.geo_zones]),[L,O]=d.useMemo(()=>{const p=s.shipping_options,f=p.filter(u=>!y(u)).length,l=p.filter(y).length;return[f,l]},[s.shipping_options]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between gap-x-4 px-6 py-4",children:[e.jsx(B,{children:e.jsx($,{})}),e.jsxs("div",{className:"grow-1 flex flex-1 flex-col",children:[e.jsx(x,{size:"small",leading:"compact",weight:"plus",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{variant:"base",list:v.map(p=>p.display_name),inline:!0,n:1}),e.jsx("span",{children:"·"}),e.jsx(x,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.shipping",{count:L})}),e.jsx("span",{children:"·"}),e.jsx(x,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.returns",{count:O})})]})]}),e.jsxs("div",{className:"flex grow-0 items-center gap-4",children:[e.jsx(me,{size:"small",onClick:()=>a(p=>!p),variant:"transparent",children:e.jsx(he,{style:{transform:`rotate(${r?180:0}deg)`,transition:".2s transform ease-in-out"}})}),e.jsx(j,{groups:[{actions:[{label:i("actions.edit"),icon:e.jsx(N,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/edit`},{label:i("stockLocations.serviceZones.manageAreas.action"),icon:e.jsx($,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/areas`}]},{actions:[{label:i("actions.delete"),icon:e.jsx(b,{}),onClick:g}]}]})]})]}),r&&e.jsx(Ee,{fulfillmentSetId:t,locationId:n,zone:s})]})}function F(s){const{t:n}=h(),t=k(),{fulfillmentSet:i,locationName:o,locationId:r,type:a}=s,c=!!i,g=!!(i!=null&&i.service_zones.length),{mutateAsync:v}=ne(r),{mutateAsync:L}=U(i==null?void 0:i.id),O=async()=>{await v({name:`${o} ${a==="pickup"?"pick up":a}`,type:a},{onSuccess:()=>{m.success(n(`stockLocations.fulfillmentSets.enable.${a}`))},onError:l=>{m.error(l.message)}})},p=async()=>{await t({title:n("general.areYouSure"),description:n("stockLocations.fulfillmentSets.disable.confirmation",{name:i==null?void 0:i.name}),confirmText:n("actions.disable"),cancelText:n("actions.cancel")})&&await L(void 0,{onSuccess:()=>{m.success(n(`stockLocations.fulfillmentSets.disable.${a}`))},onError:u=>{m.error(u.message)}})},f=i?[{actions:[{icon:e.jsx(A,{}),label:n("stockLocations.serviceZones.create.action"),to:`/settings/locations/${r}/fulfillment-set/${i.id}/service-zones/create`}]},{actions:[{icon:e.jsx(b,{}),label:n("actions.disable"),onClick:p}]}]:[{actions:[{icon:e.jsx(A,{}),label:n("actions.enable"),onClick:O}]}];return e.jsx(C,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col divide-y",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(S,{level:"h2",children:n(`stockLocations.fulfillmentSets.${a}.header`)}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ve,{color:c?"green":"grey",children:n(c?"statuses.enabled":"statuses.disabled")}),e.jsx(j,{groups:f})]})]}),c&&!g&&e.jsx("div",{className:"flex items-center justify-center py-8 pt-6",children:e.jsx(q,{message:n("stockLocations.serviceZones.fields.noRecords"),className:"h-fit",action:{to:`/settings/locations/${r}/fulfillment-set/${i.id}/service-zones/create`,label:n("stockLocations.serviceZones.create.action")}})}),g&&e.jsx("div",{className:"flex flex-col divide-y",children:i==null?void 0:i.service_zones.map(l=>e.jsx(Pe,{zone:l,locationId:r,fulfillmentSetId:i.id},l.id))})]})})}var Te=({location:s})=>{const n=de(),{t}=h(),{mutateAsync:i}=ie(s.id),o=k(),r=async()=>{await o({title:t("general.areYouSure"),description:t("stockLocations.delete.confirmation",{name:s.name}),verificationText:s.name,verificationInstruction:t("general.typeToConfirm"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await i(void 0,{onSuccess:()=>{m.success(t("stockLocations.create.successToast",{name:s.name})),n("/settings/locations",{replace:!0})},onError:c=>{m.error(c.message)}})};return e.jsx(j,{groups:[{actions:[{icon:e.jsx(N,{}),label:t("actions.edit"),to:"edit"},{icon:e.jsx(K,{}),label:t("stockLocations.edit.viewInventory"),to:`/inventory?location_id=${s.id}`}]},{actions:[{icon:e.jsx(b,{}),label:t("actions.delete"),onClick:r}]}]})};function De({location:s}){var o,r,a;const{t:n}=h(),{count:t}=xe({limit:1,fields:"id"}),i=!!((o=s.sales_channels)!=null&&o.length);return e.jsxs(C,{className:"flex flex-col px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{level:"h2",children:n("stockLocations.salesChannels.header")}),e.jsx(j,{groups:[{actions:[{label:n("actions.edit"),to:"sales-channels",icon:e.jsx(N,{})}]}]})]}),i?e.jsxs("div",{className:"flex flex-col gap-y-4 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3",children:[e.jsx(B,{children:e.jsx(ge,{className:"text-ui-fg-subtle"})}),e.jsx(R,{n:3,className:"text-ui-fg-base",inline:!0,list:((r=s.sales_channels)==null?void 0:r.map(c=>c.name))??[]})]}),e.jsx(x,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:n("stockLocations.salesChannels.connectedTo",{count:(a=s.sales_channels)==null?void 0:a.length,total:t})})]}):e.jsx(q,{className:"h-fit pb-2 pt-6",action:{label:n("stockLocations.salesChannels.action"),to:"sales-channels"},message:n("stockLocations.salesChannels.noChannels")})]})}var Ae=De,fs=()=>{const s=ae(),{location_id:n}=oe(),{stock_location:t,isPending:i,isError:o,error:r}=se(n,{fields:G},{initialData:s});if(i||!t)return e.jsx("div",{children:"Loading..."});if(o)throw r;return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[Le.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsxs("div",{className:"flex flex-col gap-y-3 xl:flex-row xl:items-start xl:gap-x-4",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-3",children:[e.jsx(Se,{location:t}),ke.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsx("div",{className:"hidden xl:block",children:e.jsx(P,{data:t})})]}),e.jsxs("div",{className:"flex w-full max-w-[100%] flex-col gap-y-3 xl:mt-0 xl:max-w-[400px]",children:[$e.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsx(Ae,{location:t}),Oe.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsx("div",{className:"xl:hidden",children:e.jsx(P,{data:t})})]}),e.jsx(re,{})]})]})};export{fs as Component,ms as loader};
