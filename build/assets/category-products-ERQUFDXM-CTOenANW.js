import{u as I}from"./chunk-QBDU475K-BjRzsrqf.js";import{v as H,j as e,u as P,r as S,t as h,x as A}from"./index-7A3rjJyE.js";import{u as B,a as D}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{b as M,d as N}from"./chunk-MMJ4V5AR-M7tiWwVa.js";import{u as L,D as O}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as V}from"./chunk-YBHG7T6S-BleHOTgO.js";import{R as u,u as q}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as G,H as Q}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as U}from"./zod-DRKIF09R.js";import{z as l}from"./index-yuYasa5Y.js";import{B as x}from"./label-DDCdtDlT.js";import{C as y}from"./checkbox-BD385cy_.js";import{c as X}from"./index-DL2eSRCZ.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-TQZNQHGA-CqGicYvo.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./x-mark-mini-Di7jARRp.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var Z=l.object({product_ids:l.array(l.string())}),m=50,p="p",$=({categoryId:c,products:o=[]})=>{const{t}=P(),{handleSuccess:s}=q(),[d,n]=S.useState(o.reduce((r,a)=>(r[a.id]=!0,r),{})),i=G({defaultValues:{product_ids:[]},resolver:U(Z)}),j=r=>{const a=typeof r=="function"?r(d):r;i.setValue("product_ids",Object.keys(a),{shouldDirty:!0,shouldTouch:!0}),n(a)},{searchParams:C,raw:b}=B({pageSize:m,prefix:p}),{products:v,count:g,isPending:_,isError:E,error:R}=V({...C,category_id:[c]}),f=K(),T=D(["categories"]),{table:w}=L({data:v,columns:f,getRowId:r=>r.id,count:g,pageSize:m,prefix:p,enableRowSelection:r=>!o.some(a=>a.id===r.original.id),enablePagination:!0,rowSelection:{state:d,updater:j}}),{mutateAsync:k,isPending:z}=N(c),F=i.handleSubmit(async r=>{await k({add:r.product_ids},{onSuccess:()=>{h.success(t("categories.products.add.disabledTooltip",{count:r.product_ids.length})),s()},onError:a=>{h.error(a.message)}})});if(E)throw R;return e.jsx(u.Form,{form:i,children:e.jsxs("form",{onSubmit:F,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(u.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[i.formState.errors.product_ids&&e.jsx(Q,{variant:"error",children:i.formState.errors.product_ids.message}),e.jsx(u.Close,{asChild:!0,children:e.jsx(x,{size:"small",variant:"secondary",children:t("actions.cancel")})}),e.jsx(x,{size:"small",type:"submit",isLoading:z,children:t("actions.save")})]})}),e.jsx(u.Body,{className:"size-full overflow-hidden",children:e.jsx(O,{table:w,columns:f,pageSize:m,count:g,queryObject:b,filters:T,orderBy:["title","created_at","updated_at"],prefix:p,isLoading:_,layout:"fill",pagination:!0,search:!0})})]})})},J=X(),K=()=>{const{t:c}=P(),o=I();return S.useMemo(()=>[J.display({id:"select",header:({table:t})=>e.jsx(y,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:s=>t.toggleAllPageRowsSelected(!!s)}),cell:({row:t})=>{const s=!t.getCanSelect(),d=t.getIsSelected()||s,n=e.jsx(y,{checked:d,disabled:s,onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}});return s?e.jsx(A,{content:c("categories.products.add.disabledTooltip"),side:"right",children:n}):n}}),...o],[c,o])},Be=()=>{const{id:c}=H(),{product_category:o,isPending:t,isError:s,error:d}=M(c,{fields:"*products"}),n=!t&&!!o;if(s)throw d;return e.jsx(u,{children:n&&e.jsx($,{categoryId:o.id,products:o.products})})};export{Be as Component};
