import{u as re,a as se}from"./chunk-WL3E5WGF-DZFGL-a4.js";import{S as te}from"./chunk-FGHVNTU2-HfmduO2_.js";import"./chunk-3IW4HYUP-C89ww9p0.js";import{r as x,q as M,h as ie,m as oe,j as s,cj as ne,cm as ae,cn as ce,k as le,o as ue,co as H,u as _,C as W,H as K,T as m,B as de,t as f}from"./index-7A3rjJyE.js";import{u as me}from"./chunk-ZAKH3ZQB-BBhcY7sJ.js";import{A as k}from"./chunk-WRXTMI2J-CygmDunM.js";import{c as pe}from"./chunk-QHCOJC4V-B0yC0oe2.js";import{S as ge}from"./chunk-ADOCJB6L-3PFdxvdK.js";import{u as xe,D as fe}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{P as he}from"./plus-o2nCfN-i.js";import{P as ve}from"./pencil-square-mUSTT5rR.js";import{X as ye}from"./x-circle-DWGyIDW-.js";import{T as _e}from"./trash-C_lucST6.js";import{u as Y}from"./use-prompt-iL3FbEo4.js";import{C as h}from"./command-bar-DBncXrlJ.js";import{C as B}from"./checkbox-BD385cy_.js";import{c as je}from"./index-DL2eSRCZ.js";import"./chunk-IQRVIEMV-JX6w9umB.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./label-DDCdtDlT.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./index-DFaNeppw.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";var Ce=Object.defineProperty,y=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,Q=(r,e,t)=>e in r?Ce(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Se=(r,e)=>{for(var t in e||(e={}))G.call(e,t)&&Q(r,t,e[t]);if(y)for(var t of y(e))J.call(e,t)&&Q(r,t,e[t]);return r},we=(r,e)=>{var t={};for(var i in r)G.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&y)for(var i of y(r))e.indexOf(i)<0&&J.call(r,i)&&(t[i]=r[i]);return t};const U=x.forwardRef((r,e)=>{var t=r,{color:i="currentColor"}=t,a=we(t,["color"]);return x.createElement("svg",Se({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:e},a),x.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 13.945a6.444 6.444 0 1 0 0-12.89 6.444 6.444 0 0 0 0 12.89"}),x.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m4.611 7.722 2 2.223 3.778-4.89"}))});U.displayName="CheckCircle";const Pe={widgets:[]},be={widgets:[]};var ke=()=>({queryKey:ae.details(),queryFn:async()=>ce()}),yr=async()=>{const r=ke();return M.getQueryData(r.queryKey)??await M.fetchQuery(r)},P=10,Te=({store:r})=>{var I,O,N,R,z,D,A,q;const[e,t]=x.useState({}),{searchParams:i,raw:a}=re({pageSize:P}),{currencies:c,count:o,isPending:p,isError:j,error:C}=me({code:(I=r.supported_currencies)==null?void 0:I.map(n=>n.currency_code),...i},{placeholderData:le,enabled:!!((O=r.supported_currencies)!=null&&O.length)}),{price_preferences:g,isPending:v,isError:d,error:l}=ue({attribute:"currency_code",value:(N=r.supported_currencies)==null?void 0:N.map(n=>n.currency_code)},{enabled:!!((R=r.supported_currencies)!=null&&R.length)}),T=Ie(),E=x.useMemo(()=>new Map(g==null?void 0:g.map(n=>[n.value,n])),[g]),V=c==null?void 0:c.map(n=>{var S;return{...n,is_tax_inclusive:(S=E.get(n.code))==null?void 0:S.is_tax_inclusive}}),{table:X}=xe({data:V??[],columns:T,count:o,getRowId:n=>n.code,rowSelection:{state:e,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:P,meta:{storeId:r.id,supportedCurrencies:r.supported_currencies,defaultCurrencyCode:(D=(z=r.supported_currencies)==null?void 0:z.find(n=>n.is_default))==null?void 0:D.currency_code,preferencesMap:E}}),{mutateAsync:F}=H(r.id),{t:u}=_(),Z=Y(),$=async()=>{var L;const n=Object.keys(e);await Z({title:u("general.areYouSure"),description:u("store.removeCurrencyWarning",{count:n.length}),confirmText:u("actions.remove"),cancelText:u("actions.cancel")})&&await F({supported_currencies:((L=r.supported_currencies)==null?void 0:L.filter(w=>!n.includes(w.currency_code)))??[]},{onSuccess:()=>{t({}),f.success(u("store.toast.currenciesRemoved"))},onError:w=>{f.error(w.message)}})};if(j)throw C;if(d)throw l;const ee=p||v;return s.jsxs(W,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(K,{level:"h2",children:u("store.currencies")}),s.jsx(k,{groups:[{actions:[{icon:s.jsx(he,{}),label:u("actions.add"),to:"currencies"}]}]})]}),s.jsx(fe,{orderBy:["code","name"],search:!0,pagination:!0,table:X,pageSize:P,columns:T,count:(A=r.supported_currencies)!=null&&A.length?o:0,isLoading:(q=r.supported_currencies)!=null&&q.length?ee:!1,queryObject:a}),s.jsx(h,{open:!!Object.keys(e).length,children:s.jsxs(h.Bar,{children:[s.jsx(h.Value,{children:u("general.countSelected",{count:Object.keys(e).length})}),s.jsx(h.Seperator,{}),s.jsx(h.Command,{action:$,shortcut:"r",label:u("actions.remove")})]})})]})},Ee=({storeId:r,currency:e,supportedCurrencies:t,defaultCurrencyCode:i,preferencesMap:a})=>{var g,v;const{mutateAsync:c}=H(r),{t:o}=_(),p=Y(),j=async()=>{await p({title:o("general.areYouSure"),description:o("store.removeCurrencyWarning",{count:1}),verificationInstruction:o("general.typeToConfirm"),verificationText:e.name,confirmText:o("actions.remove"),cancelText:o("actions.cancel")})&&await c({supported_currencies:t.filter(l=>l.currency_code!==e.code)},{onSuccess:()=>{f.success(o("store.toast.currenciesRemoved"))},onError:l=>{f.error(l.message)}})},C=async()=>{await c({supported_currencies:t.map(d=>{const l=a.get(d.currency_code);return{...d,is_tax_inclusive:d.currency_code===e.code?!(l!=null&&l.is_tax_inclusive):void 0}})},{onSuccess:()=>{f.success(o("store.toast.updatedTaxInclusivitySuccessfully"))},onError:d=>{f.error(d.message)}})};return s.jsx(k,{groups:[{actions:[{icon:(g=a.get(e.code))!=null&&g.is_tax_inclusive?s.jsx(ye,{}):s.jsx(U,{}),label:(v=a.get(e.code))!=null&&v.is_tax_inclusive?o("store.disableTaxInclusivePricing"):o("store.enableTaxInclusivePricing"),onClick:C}]},{actions:[{icon:s.jsx(_e,{}),label:o("actions.remove"),onClick:j,disabled:e.code===i}]}]})},b=je(),Ie=()=>{const r=se(),{t:e}=_();return x.useMemo(()=>[b.display({id:"select",header:({table:t})=>s.jsx(B,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:i=>t.toggleAllPageRowsSelected(!!i)}),cell:({row:t})=>s.jsx(B,{checked:t.getIsSelected(),onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}})}),...r,b.accessor("is_tax_inclusive",{header:e("fields.taxInclusivePricing"),cell:({getValue:t})=>{const i=t();return s.jsx(ge,{color:i?"green":"grey",children:e(i?"fields.true":"fields.false")})}}),b.display({id:"actions",cell:({row:t,table:i})=>{const{supportedCurrencies:a,storeId:c,defaultCurrencyCode:o,preferencesMap:p}=i.options.meta;return s.jsx(Ee,{storeId:c,currency:t.original,supportedCurrencies:a,defaultCurrencyCode:o,preferencesMap:p})}})],[r,e])},Oe=({store:r})=>{var a,c,o;const{t:e}=_(),{region:t}=pe(r.default_region_id,void 0,{enabled:!!r.default_region_id}),i=(a=r.supported_currencies)==null?void 0:a.find(p=>p.is_default);return s.jsxs(W,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{children:[s.jsx(K,{children:e("store.domain")}),s.jsx(m,{className:"text-ui-fg-subtle",size:"small",children:e("store.manageYourStoresDetails")})]}),s.jsx(k,{groups:[{actions:[{icon:s.jsx(ve,{}),label:e("actions.edit"),to:"edit"}]}]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(m,{size:"small",leading:"compact",weight:"plus",children:e("fields.name")}),s.jsx(m,{size:"small",leading:"compact",children:r.name})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(m,{size:"small",leading:"compact",weight:"plus",children:e("store.defaultCurrency")}),i?s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(de,{size:"2xsmall",children:(c=i.currency_code)==null?void 0:c.toUpperCase()}),s.jsx(m,{size:"small",leading:"compact",children:(o=i.currency)==null?void 0:o.name})]}):s.jsx(m,{size:"small",leading:"compact",children:"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(m,{size:"small",leading:"compact",weight:"plus",children:e("store.defaultRegion")}),s.jsx("div",{className:"flex items-center gap-x-2",children:s.jsx(m,{size:"small",leading:"compact",children:(t==null?void 0:t.name)||"-"})})]})]})},_r=()=>{const r=ie(),{store:e,isPending:t,isError:i,error:a}=oe(void 0,{initialData:r});if(t||!e)return s.jsx(ne,{sections:2,showJSON:!0,showMetadata:!0});if(i)throw a;return s.jsxs(te,{widgets:{before:be,after:Pe},data:e,hasOutlet:!0,showMetadata:!0,showJSON:!0,children:[s.jsx(Oe,{store:e}),s.jsx(Te,{store:e})]})};export{_r as Component,yr as loader};
