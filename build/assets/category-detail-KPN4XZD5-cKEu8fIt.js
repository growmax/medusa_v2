import{L as B}from"./chunk-6WKBBTKM-C1QI-Gio.js";import{u as M}from"./chunk-PGU3HA6B-D4UwUxms.js";import{a as O,b as Q,g as F,c as H}from"./chunk-54IEHX46-DWMq7yL7.js";import{J as N}from"./chunk-3IW4HYUP-C89ww9p0.js";import{u as K}from"./chunk-QBDU475K-BjRzsrqf.js";import{v as $,h as G,j as e,O as J,q as P,u as h,C as v,H as y,T as c,r as u,W as T,x as V,E as j,B as U,L as W,k as Y,p as Z,t as S}from"./index-7A3rjJyE.js";import{u as X,a as ee}from"./chunk-OGPZJ7JQ-9Z-hWx5h.js";import{A as w}from"./chunk-WRXTMI2J-CygmDunM.js";import{b,d as se,c as te}from"./chunk-MMJ4V5AR-M7tiWwVa.js";import{u as ae,D as re}from"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{u as ie}from"./chunk-YBHG7T6S-BleHOTgO.js";import{P as D}from"./pencil-square-mUSTT5rR.js";import{T as oe}from"./trash-C_lucST6.js";import{F as z}from"./folder-illustration-CD44GHLh.js";import{P as le}from"./plus-mini-BHxdUq8n.js";import{u as ce}from"./use-prompt-iL3FbEo4.js";import{S as k}from"./status-badge-BK5p0WUV.js";import{C as g}from"./command-bar-DBncXrlJ.js";import{C as _}from"./checkbox-BD385cy_.js";import{c as ne}from"./index-DL2eSRCZ.js";import"./arrow-up-right-on-box-CF7GLQ-o.js";import"./Trans-Cyi6soNY.js";import"./x-mark-mini-Di7jARRp.js";import"./triangle-down-mini-BHNqpDM0.js";import"./square-two-stack-Ao9P_yLE.js";import"./chunk-6XHB4MRO-DKQXmGFz.js";import"./chunk-PHMALPVO-EKeNghx2.js";import"./chunk-ADOCJB6L-3PFdxvdK.js";import"./chunk-P3UUX2T6-Bigsa15J.js";import"./chunk-OPYB3EPU-B_-LG2wj.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./chunk-TQZNQHGA-CqGicYvo.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./label-DDCdtDlT.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./index-DFaNeppw.js";import"./chunk-DMYZ6SLX-BMyt3Z-P.js";import"./prompt-KZNvJYzq.js";import"./index-dBm6oMZZ.js";const de={widgets:[]},me={widgets:[]},pe={widgets:[]},xe={widgets:[]};var ge=({category:a})=>{const{t:s}=h(),t=O(a.is_active,s),i=Q(a.is_internal,s),l=M(a);return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{children:a.name}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(k,{color:t.color,children:t.label}),e.jsx(k,{color:i.color,children:i.label})]}),e.jsx(w,{groups:[{actions:[{label:s("actions.edit"),icon:e.jsx(D,{}),to:"edit"}]},{actions:[{label:s("actions.delete"),icon:e.jsx(oe,{}),onClick:l}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("fields.description")}),e.jsx(c,{size:"small",leading:"compact",children:a.description||"-"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("fields.handle")}),e.jsxs(c,{size:"small",leading:"compact",children:["/",a.handle]})]})]})},ue=({category:a})=>{const{t:s}=h();return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{level:"h2",children:s("categories.organize.header")}),e.jsx(w,{groups:[{actions:[{label:s("categories.organize.action"),icon:e.jsx(D,{}),to:"organize"}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("categories.fields.path.label")}),e.jsx(he,{category:a})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("categories.fields.children.label")}),e.jsx(je,{category:a})]})]})},he=({category:a})=>{const[s,t]=u.useState(!1),{t:i}=h(),{product_category:l,isLoading:m,isError:r,error:n}=b(a.id,{include_ancestors_tree:!0,fields:"id,name,*parent_category"}),o=u.useMemo(()=>F(l),[l]);if(m||!l)return e.jsx(T,{className:"h-5 w-16"});if(r)throw n;return o.length?o.length>1&&!s?e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-x-2",children:[e.jsx(z,{}),e.jsxs("div",{className:"flex items-center gap-x-0.5",children:[e.jsx(V,{content:i("categories.fields.path.tooltip"),children:e.jsx("button",{className:"outline-none",type:"button",onClick:()=>t(!0),children:e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",children:"..."})})}),e.jsx(j,{}),e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",className:"truncate",children:o[o.length-1].name})]})]}):o.length>1&&s?e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-x-2",children:[e.jsx(z,{}),e.jsx("div",{className:"gap- flex flex-wrap items-center gap-x-0.5 gap-y-1",children:o.map((d,x)=>e.jsxs("div",{className:"flex items-center gap-x-0.5",children:[x===o.length-1?e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",children:d.name}):e.jsx(B,{to:`/categories/${d.id}`,className:"txt-compact-xsmall-plus text-ui-fg-subtle hover:text-ui-fg-base focus-visible:text-ui-fg-base",children:d.name}),x<o.length-1&&e.jsx(j,{})]},d.id))})]}):e.jsx("div",{className:"grid grid-cols-1 items-start gap-x-2",children:o.map((d,x)=>e.jsxs("div",{className:"flex items-center gap-x-0.5",children:[e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",children:d.name}),x<o.length-1&&e.jsx(j,{})]},d.id))}):e.jsx(c,{size:"small",leading:"compact",children:"-"})},je=({category:a})=>{const{product_category:s,isLoading:t,isError:i,error:l}=b(a.id,{include_descendants_tree:!0,fields:"id,name,category_children"}),m=u.useMemo(()=>H(s),[s]);if(t||!s)return e.jsx(T,{className:"h-5 w-16"});if(i)throw l;return m.length?e.jsx("div",{className:"flex flex-wrap gap-1",children:m.map(r=>e.jsx(U,{size:"2xsmall",asChild:!0,children:e.jsx(W,{to:`/categories/${r.id}`,children:r.name})},r.id))}):e.jsx(c,{size:"small",leading:"compact",children:"-"})},f=10,fe=({category:a})=>{const{t:s}=h(),t=ce(),[i,l]=u.useState({}),{raw:m,searchParams:r}=X({pageSize:f}),{products:n,count:o,isLoading:d,isError:x,error:E}=ie({...r,category_id:[a.id]},{placeholderData:Y}),C=ye(),L=ee(["categories"]),{table:R}=ae({data:n||[],columns:C,count:o,getRowId:p=>p.id,pageSize:f,enableRowSelection:!0,enablePagination:!0,rowSelection:{state:i,updater:l}}),{mutateAsync:A}=se(a.id),I=async()=>{const p=Object.keys(i);await t({title:s("general.areYouSure"),description:s("categories.products.remove.confirmation",{count:p.length}),confirmText:s("actions.remove"),cancelText:s("actions.cancel")})&&await A({remove:p},{onSuccess:()=>{S.success(s("categories.products.remove.successToast",{count:p.length})),l({})},onError:q=>{S.error(q.message)}})};if(x)throw E;return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{level:"h2",children:s("products.domain")}),e.jsx(w,{groups:[{actions:[{label:s("actions.add"),icon:e.jsx(le,{}),to:"products"}]}]})]}),e.jsx(re,{table:R,filters:L,columns:C,orderBy:["title","created_at","updated_at"],pageSize:f,count:o,navigateTo:p=>`/products/${p.id}`,isLoading:d,queryObject:m,noRecords:{message:s("categories.products.list.noRecordsMessage")}}),e.jsx(g,{open:!!Object.keys(i).length,children:e.jsxs(g.Bar,{children:[e.jsx(g.Value,{children:s("general.countSelected",{count:Object.keys(i).length})}),e.jsx(g.Seperator,{}),e.jsx(g.Command,{action:I,label:s("actions.remove"),shortcut:"r"})]})})]})},ve=ne(),ye=()=>{const a=K();return u.useMemo(()=>[ve.display({id:"select",header:({table:s})=>e.jsx(_,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t)}),cell:({row:s})=>e.jsx(_,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...a],[a])},js=()=>{const{id:a}=$(),s=G(),{product_category:t,isLoading:i,isError:l,error:m}=b(a,void 0,{initialData:s});if(i||!t)return e.jsx("div",{children:"Loading..."});if(l)throw m;return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[me.widgets.map((r,n)=>e.jsx("div",{children:e.jsx(r.Component,{data:t})},n)),e.jsxs("div",{className:"flex flex-col gap-x-4 gap-y-3 xl:flex-row xl:items-start",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-3",children:[e.jsx(ge,{category:t}),e.jsx(fe,{category:t}),de.widgets.map((r,n)=>e.jsx("div",{children:e.jsx(r.Component,{data:t})},n)),e.jsx("div",{className:"hidden xl:block",children:e.jsx(N,{data:t})})]}),e.jsxs("div",{className:"flex w-full max-w-[100%] flex-col gap-y-3 xl:max-w-[400px]",children:[xe.widgets.map((r,n)=>e.jsx("div",{children:e.jsx(r.Component,{data:t})},n)),e.jsx(ue,{category:t}),pe.widgets.map((r,n)=>e.jsx("div",{children:e.jsx(r.Component,{data:t})},n)),e.jsx("div",{className:"xl:hidden",children:e.jsx(N,{data:t})})]})]}),e.jsx(J,{})]})},we=a=>({queryKey:te.detail(a),queryFn:async()=>Z.categories.retrieve(a)}),fs=async({params:a})=>{const s=a.id,t=we(s);return P.getQueryData(t.queryKey)??await P.fetchQuery(t)};export{js as Component,fs as loader};
