import{D as q}from"./chunk-5FUV23JF-QRqJ2E8j.js";import{D as J,T as j}from"./chunk-RKBIB2RM-jqr0zPdv.js";import{N as X,a as Y}from"./chunk-WX2SMNCD-D4nWbVrW.js";import{D as Z}from"./chunk-7LAPOKHJ-BtMb3RyP.js";import{r as p,j as e,ao as G,g as u,d as _,u as U,L as ee}from"./index-7A3rjJyE.js";import{u as te,f as K,g as se,a as ae,b as le}from"./index-DL2eSRCZ.js";import{C as I}from"./command-bar-DBncXrlJ.js";var oe=({search:s,orderBy:l,filters:c,prefix:r})=>(s||l||c||r)&&e.jsxs("div",{className:"flex items-start justify-between gap-x-4 px-6 py-4",children:[e.jsx("div",{className:"w-full max-w-[60%]",children:c&&c.length>0&&e.jsx(Z,{filters:c,prefix:r})}),e.jsxs("div",{className:"flex shrink-0 items-center gap-x-2",children:[s&&e.jsx(q,{prefix:r}),l&&e.jsx(J,{keys:l,prefix:r})]})]}),ne=({table:s,columns:l,pagination:c,navigateTo:r,commands:n,count:v=0,noResults:N=!1,layout:o="fit"})=>{const{t:m}=U(),[k,P]=p.useState(!1),w=p.useRef(null),f=l.find(t=>t.id==="select"),b=l.find(t=>t.id==="actions"),S=n&&n.length>0,d=s.getState().rowSelection,{pageIndex:x,pageSize:y}=s.getState().pagination,L=100/(l.length-(f?1:0)-(b?1:0)),O=t=>{t.currentTarget.scrollLeft>0?P(!0):P(!1)},E=async t=>{await t(d).then(()=>{s.resetRowSelection()})};return p.useEffect(()=>{var t;(t=w.current)==null||t.scroll({top:0,left:0})},[x]),e.jsxs("div",{className:u("flex w-full flex-col overflow-hidden",{"flex flex-1 flex-col":o==="fill"}),children:[e.jsx("div",{ref:w,onScroll:O,className:u("w-full",{"min-h-0 flex-grow overflow-auto":o==="fill","overflow-x-auto":o==="fit"}),children:N?e.jsx("div",{className:u({"border-b":o==="fit"}),children:e.jsx(Y,{})}):e.jsxs(j,{className:"relative w-full",children:[e.jsx(j.Header,{className:"border-t-0",children:s.getHeaderGroups().map(t=>e.jsx(j.Row,{className:u({"relative border-b-0 [&_th:last-of-type]:w-[1%] [&_th:last-of-type]:whitespace-nowrap":b,"[&_th:first-of-type]:w-[1%] [&_th:first-of-type]:whitespace-nowrap":f}),children:t.headers.map((a,D)=>{const H=a.id==="actions",h=a.id==="select",i=H||h,C=t.headers.findIndex(R=>R.id!=="select"),T=C!==-1?a.id===t.headers[C].id:D===0,g=h||T;return e.jsx(j.HeaderCell,{"data-table-header-id":a.id,style:{width:i?void 0:`${L}%`},className:u({"bg-ui-bg-base sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":g,"left-[68px]":g&&f&&!h,"after:bg-ui-border-base":k&&g&&!i}),children:K(a.column.columnDef.header,a.getContext())},a.id)})},t.id))}),e.jsx(j.Body,{className:"border-b-0",children:s.getRowModel().rows.map(t=>{const a=r?r(t):void 0,D=f&&!t.getCanSelect(),H=t.depth%2!==0,h=t.getVisibleCells();return e.jsx(j.Row,{"data-selected":t.getIsSelected(),className:u("transition-fg group/row group relative [&_td:last-of-type]:w-[1%] [&_td:last-of-type]:whitespace-nowrap","has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover",{"bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover":H,"cursor-pointer":!!a,"bg-ui-bg-highlight hover:bg-ui-bg-highlight-hover":t.getIsSelected(),"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":D}),children:h.map((i,C)=>{const T=t.getVisibleCells(),g=i.column.id==="select",R=T.findIndex(W=>W.column.id!=="select"),A=R!==-1?i.column.id===T[R].column.id:C===0,z=g||A,F=t.depth>0&&A?t.depth*14+24:void 0,$=z&&f&&!g,Q=K(i.column.columnDef.cell,i.getContext()),V=A&&!!a,B=!!a&&!g;return e.jsx(j.Cell,{className:u({"!pl-0 !pr-0":B,"bg-ui-bg-base group-data-[selected=true]/row:bg-ui-bg-highlight group-data-[selected=true]/row:group-hover/row:bg-ui-bg-highlight-hover group-hover/row:bg-ui-bg-base-hover transition-fg group-has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":z,"bg-ui-bg-subtle group-hover/row:bg-ui-bg-subtle-hover":H&&z,"left-[68px]":$,"after:bg-ui-border-base":k&&z&&!g,"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":D}),style:{paddingLeft:F?`${F}px`:void 0},children:B?e.jsx(ee,{to:a,className:"size-full outline-none","data-row-link":!0,tabIndex:V?0:-1,children:e.jsx("div",{className:u("flex size-full items-center pr-6",{"pl-6":V&&!$}),children:Q})}):Q},i.id)})},t.id)})})]})}),c&&e.jsx("div",{className:u({"border-t":o==="fill"}),children:e.jsx(re,{canNextPage:s.getCanNextPage(),canPreviousPage:s.getCanPreviousPage(),nextPage:s.nextPage,previousPage:s.previousPage,count:v,pageIndex:x,pageCount:s.getPageCount(),pageSize:y})}),S&&e.jsx(I,{open:!!Object.keys(d).length,children:e.jsxs(I.Bar,{children:[e.jsx(I.Value,{children:m("general.countSelected",{count:Object.keys(d).length})}),e.jsx(I.Seperator,{}),n==null?void 0:n.map((t,a)=>e.jsxs(p.Fragment,{children:[e.jsx(I.Command,{label:t.label,shortcut:t.shortcut,action:()=>E(t.action)}),a<n.length-1&&e.jsx(I.Seperator,{})]},a))]})})]})},re=s=>{const{t:l}=U(),c={of:l("general.of"),results:l("general.results"),pages:l("general.pages"),prev:l("general.prev"),next:l("general.next")};return e.jsx(j.Pagination,{className:"flex-shrink-0",...s,translations:c})},ie=p.memo(oe),xe=({table:s,columns:l,pagination:c,navigateTo:r,commands:n,count:v=0,search:N=!1,orderBy:o,filters:m,prefix:k,queryObject:P={},pageSize:w,isLoading:f=!1,layout:b="fit",noRecords:S={}})=>{if(f)return e.jsx(G,{layout:b,rowCount:w,search:N,filters:!!(m!=null&&m.length),orderBy:!!(o!=null&&o.length),pagination:!!c});const d=Object.values(P).filter(M=>!!M).length===0,x=!f&&v===0&&!d;return!f&&v===0&&d?e.jsx(X,{className:u({"flex h-full flex-col overflow-hidden":b==="fill"}),...S}):e.jsxs("div",{className:u("divide-y",{"flex h-full flex-col overflow-hidden":b==="fill"}),children:[e.jsx(ie,{search:N,orderBy:o,filters:m,prefix:k}),e.jsx(ne,{table:s,count:v,columns:l,pagination:!0,navigateTo:r,commands:n,noResults:x,layout:b})]})},pe=({data:s=[],columns:l,count:c=0,pageSize:r=20,enablePagination:n=!0,enableRowSelection:v=!1,enableExpandableRows:N=!1,rowSelection:o,getSubRows:m,getRowId:k,meta:P,prefix:w})=>{const[f,b]=_(),S=`${w?`${w}_`:""}offset`,d=f.get(S),[{pageIndex:x,pageSize:y},M]=p.useState({pageIndex:d?Math.ceil(Number(d)/r):0,pageSize:r}),L=p.useMemo(()=>({pageIndex:x,pageSize:y}),[x,y]),[O,E]=p.useState({}),t=(o==null?void 0:o.state)??O,a=(o==null?void 0:o.updater)??E;p.useEffect(()=>{if(!n)return;const h=d?Math.ceil(Number(d)/r):0;h!==x&&M(i=>({...i,pageIndex:h}))},[d,n,r,x]);const D=h=>{const i=h(L),{pageIndex:C,pageSize:T}=i;return b(g=>{if(!C)return g.delete(S),g;const R=new URLSearchParams(g);return R.set(S,String(C*T)),R}),M(i),i};return{table:te({data:s,columns:l,state:{rowSelection:t,pagination:n?L:void 0},pageCount:Math.ceil((c??0)/y),enableRowSelection:v,getRowId:k,getSubRows:m,onRowSelectionChange:v?a:void 0,onPaginationChange:n?D:void 0,getCoreRowModel:se(),getPaginationRowModel:n?ae():void 0,getExpandedRowModel:N?le():void 0,manualPagination:n?!0:void 0,meta:P})}};export{xe as D,pe as u};
