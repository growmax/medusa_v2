import{G as j}from"./chunk-WB4H3U4D-D9lcj-B2.js";import{v as S,J as w,j as e,u as C,r as F,t as g,H as Z,I as b,bZ as L}from"./index-7A3rjJyE.js";import{b as k}from"./chunk-KUDWRWS3-C4McOvyT.js";import{u as _}from"./chunk-OIW3F4EQ-D8V0uZdG.js";import"./chunk-ESMNJXW4-DaLuphnU.js";import{S as v}from"./chunk-6WYMDHSN-CdicKQQM.js";import"./chunk-MOFW5DA3-Byx5Qi5u.js";import"./lodash-8s6kkRaG.js";import"./chunk-7LAPOKHJ-BtMb3RyP.js";import"./chunk-M566SHKI-Cmdx6k9x.js";import{R as c,u as N}from"./chunk-BHGSRQH6-2xCUuk1R.js";import{u as E,F as a}from"./chunk-C7RYT3S3-C_x8NvOf.js";import{t as I}from"./zod-DRKIF09R.js";import{z as t}from"./index-yuYasa5Y.js";import{B as y}from"./label-DDCdtDlT.js";import"./chunk-NOAFLTPV-CWOM6qcu.js";import"./chunk-C76H5USB-qWdDTOoY.js";import"./index-DL2eSRCZ.js";import"./checkbox-BD385cy_.js";import"./index-dBm6oMZZ.js";import"./chunk-MWKG2EGE-VcYUZG_Z.js";import"./x-mark-mini-Di7jARRp.js";import"./chunk-5FUV23JF-QRqJ2E8j.js";import"./chunk-RKBIB2RM-jqr0zPdv.js";import"./chunk-WX2SMNCD-D4nWbVrW.js";import"./plus-mini-BHxdUq8n.js";import"./command-bar-DBncXrlJ.js";import"./index-DFaNeppw.js";import"./chunk-QAF7PVQE-exoP4XGT.js";import"./format-CkWRMO1y.js";import"./_baseIsEqual-D9C7gzzJ.js";import"./date-picker-foikjjE_.js";import"./clsx-B-dksMZM.js";import"./prompt-KZNvJYzq.js";var z=t.object({name:t.string().min(1),countries:t.array(t.object({iso_2:t.string().min(2),display_name:t.string()})).min(1)});function O({fulfillmentSet:m,type:l,location:r}){const{t:s}=C(),{handleSuccess:u}=N(),[p,o]=F.useState(!1),i=E({defaultValues:{name:"",countries:[]},resolver:I(z)}),{mutateAsync:f,isPending:d}=k(m.id),x=i.handleSubmit(async n=>{await f({name:n.name,geo_zones:n.countries.map(({iso_2:h})=>({country_code:h,type:"country"}))},{onSuccess:()=>{g.success(s("stockLocations.serviceZones.create.successToast",{name:n.name})),u(`/settings/locations/${r.id}`)},onError:h=>{g.error(h.message)}})});return e.jsx(c.Form,{form:i,children:e.jsxs("form",{className:"flex h-full flex-col overflow-hidden",onSubmit:x,children:[e.jsx(c.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(c.Close,{asChild:!0,children:e.jsx(y,{variant:"secondary",size:"small",children:s("actions.cancel")})}),e.jsx(y,{type:"submit",size:"small",isLoading:d,children:s("actions.save")})]})}),e.jsx(c.Body,{className:"m-auto flex h-full w-full  flex-col items-center divide-y overflow-hidden",children:e.jsxs(v,{open:p,onOpenChange:o,children:[e.jsx(v.Content,{children:e.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[e.jsx(Z,{children:l==="pickup"?s("stockLocations.serviceZones.create.headerPickup",{location:r.name}):s("stockLocations.serviceZones.create.headerShipping",{location:r.name})}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:e.jsx(a.Field,{control:i.control,name:"name",render:({field:n})=>e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:s("fields.name")}),e.jsx(a.Control,{children:e.jsx(b,{...n})}),e.jsx(a.ErrorMessage,{})]})})}),e.jsx(L,{children:s("stockLocations.serviceZones.fields.tip")}),e.jsx(j,{form:i,onOpenChange:o})]})})}),e.jsx(j.AreaDrawer,{form:i,open:p,onOpenChange:o})]})})]})})}function xe(){var d;const{fset_id:m,location_id:l}=S(),{stock_location:r,isLoading:s,isError:u,error:p}=_(l,{fields:"*fulfillment_sets"}),o=(d=r==null?void 0:r.fulfillment_sets)==null?void 0:d.find(x=>x.id===m),i=!s&&!!r&&!!o,f=(o==null?void 0:o.type)==="pickup"?"pickup":"shipping";if(!s&&!o)throw w({message:`Fulfillment set with ID: ${m} was not found.`},404);if(u)throw p;return e.jsx(c,{prev:`/settings/locations/${l}`,children:i&&e.jsx(O,{fulfillmentSet:o,type:f,location:r})})}export{xe as Component};
