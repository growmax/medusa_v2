import{u as E}from"./chunk-C76H5USB-qWdDTOoY.js";import{u as y,L as O}from"./chunk-XIMVTANT-biTHDTmX.js";import{T as k,u as B}from"./chunk-VNYVDWWH-BElGsP_6.js";import{u as M}from"./chunk-7TY4Y7TY-B3QhHT0B.js";import{u as D}from"./chunk-YVTBRLIE-C161Iqr5.js";import{A as T}from"./chunk-WRXTMI2J-CygmDunM.js";import{u as A}from"./chunk-OPYB3EPU-B_-LG2wj.js";import{u as f,j as e,T as m,cB as I,L,d as q,r as v,a4 as $,a5 as F,n as G,E as Q,a6 as V,D as J,B as N,x as K}from"./index-7A3rjJyE.js";import{D as U}from"./chunk-5FUV23JF-QRqJ2E8j.js";import{D as H}from"./chunk-RKBIB2RM-jqr0zPdv.js";import{a as W,N as X}from"./chunk-WX2SMNCD-D4nWbVrW.js";import{u as Y}from"./chunk-YBHG7T6S-BleHOTgO.js";import{u as Z,g as ee,a as se}from"./index-DL2eSRCZ.js";import{P as w}from"./pencil-square-mUSTT5rR.js";import{T as R}from"./trash-C_lucST6.js";import{A as te}from"./arrow-down-right-mini-XNsj1UGy.js";import{S as z}from"./status-badge-BK5p0WUV.js";import{B as ae}from"./label-DDCdtDlT.js";var Ce=({prefix:s,pageSize:t=20})=>{const a=E(["offset","q","order","created_at","updated_at"],s),{offset:i,q:l,order:o,created_at:r,updated_at:n}=a;return{searchParams:{limit:t,offset:i?Number(i):0,order:o,created_at:r?JSON.parse(r):void 0,updated_at:n?JSON.parse(n):void 0,q:l},raw:a}},re=new Intl.NumberFormat([],{style:"percent",minimumFractionDigits:2}),C=(s,t=!1)=>{let a=s||0;return t||(a=a/100),re.format(a)},Se=({taxRate:s,isSublevelTaxRate:t})=>{const{t:a}=f();return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-[1fr_1fr_auto] items-center gap-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(m,{size:"small",weight:"plus",leading:"compact",children:s.name}),s.code&&e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(m,{size:"small",leading:"compact",children:"·"}),e.jsx(m,{size:"small",leading:"compact",children:s.code})]})]}),e.jsx(m,{size:"small",leading:"compact",children:C(s.rate)}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t&&e.jsx(z,{color:s.is_combinable?"green":"grey",children:s.is_combinable?a("taxRegions.fields.isCombinable.true"):a("taxRegions.fields.isCombinable.false")}),e.jsx(ie,{taxRate:s})]})]})},ie=({taxRate:s})=>{const{t}=f(),a=y(s);return e.jsx(T,{groups:[{actions:[{label:t("actions.edit"),icon:e.jsx(w,{}),to:`tax-rates/${s.id}/edit`}]},{actions:[{label:t("actions.delete"),icon:e.jsx(R,{}),onClick:a}]}]})},ne=({taxRate:s})=>{const{t}=f(),a=y(s);if(s.is_default)return null;const i=s.rules.reduce((r,n)=>(r[n.reference]||(r[n.reference]=[]),r[n.reference].push(n.reference_id),r),{}),l=Object.values(k),o=Object.keys(i).map(r=>l.includes(r)).length;return e.jsxs($,{children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(F,{asChild:!0,children:e.jsx(G,{size:"2xsmall",variant:"transparent",className:"group",children:e.jsx(Q,{className:"text-ui-fg-muted transition-transform group-data-[state='open']:rotate-90"})})}),e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(m,{size:"small",weight:"plus",leading:"compact",children:s.name}),s.code&&e.jsxs("div",{className:"text-ui-fg-subtle flex items-center gap-x-1.5",children:[e.jsx(m,{size:"small",leading:"compact",children:"·"}),e.jsx(m,{size:"small",leading:"compact",children:s.code})]})]})]}),e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(m,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:t("taxRegions.fields.targets.numberOfTargets",{count:o})}),e.jsx("div",{className:"bg-ui-border-base h-3 w-px"}),e.jsx(z,{color:s.is_combinable?"green":"grey",children:s.is_combinable?t("taxRegions.fields.isCombinable.true"):t("taxRegions.fields.isCombinable.false")}),e.jsx(T,{groups:[{actions:[{label:t("actions.edit"),icon:e.jsx(w,{}),to:`overrides/${s.id}/edit`}]},{actions:[{label:t("actions.delete"),icon:e.jsx(R,{}),onClick:a}]}]})]})]}),e.jsx(V,{children:e.jsxs("div",{className:"bg-ui-bg-subtle",children:[e.jsx(J,{variant:"dashed"}),e.jsx("div",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("div",{className:"text-ui-fg-muted flex size-5 items-center justify-center",children:e.jsx(te,{})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-1.5 gap-y-2",children:[e.jsx(N,{size:"2xsmall",children:C(s.rate)}),e.jsx(m,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:t("taxRegions.fields.targets.operators.on")}),Object.entries(i).map(([r,n],d)=>e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(oe,{reference:r,ids:n},r),d<Object.keys(i).length-1&&e.jsx(m,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:t("taxRegions.fields.targets.operators.and")})]},r))]})]})})]})})]})},oe=({reference:s,ids:t})=>e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(le,{reference:s}),e.jsx(ce,{type:s,ids:t})]}),le=({reference:s})=>{const{t}=f();let a=null;switch(s){case"products":a=t("taxRegions.fields.targets.tags.product");break;case"product_collections":a=t("taxRegions.fields.targets.tags.productCollection");break;case"product_tags":a=t("taxRegions.fields.targets.tags.productTag");break;case"product_types":a=t("taxRegions.fields.targets.tags.productType");break;case"customer_groups":a=t("taxRegions.fields.targets.tags.customerGroup");break}return a?e.jsx(N,{size:"2xsmall",children:a}):null},ce=({type:s,ids:t})=>{const{t:a}=f(),{isPending:i,additional:l,labels:o,isError:r,error:n}=de(s,t);if(r)throw n;return i?e.jsx("div",{className:"bg-ui-tag-neutral-bg border-ui-tag-neutral-border h-5 w-14 animate-pulse rounded-md"}):e.jsx(K,{content:e.jsxs("ul",{children:[o==null?void 0:o.map((d,u)=>e.jsx("li",{children:d},u)),l>0&&e.jsx("li",{children:a("taxRegions.fields.targets.additionalValues",{count:l})})]}),children:e.jsx(N,{size:"2xsmall",children:a("taxRegions.fields.targets.values",{count:t.length})})})},de=(s,t)=>{var n,d,u,g,x;const a=Y({id:t,limit:10},{enabled:!!t.length&&s==="products"}),i=B({id:t,limit:10},{enabled:!!t.length&&s==="product_tags"}),l=A({id:t,limit:10},{enabled:!!t.length&&s==="product_types"}),o=M({id:t,limit:10},{enabled:!!t.length&&s==="product_collections"}),r=D({id:t,limit:10},{enabled:!!t.length&&s==="customer_groups"});switch(s){case"products":return{labels:(n=a.products)==null?void 0:n.map(c=>c.title),isPending:a.isPending,additional:a.products&&a.count?a.count-a.products.length:0,isError:a.isError,error:a.error};case"product_tags":return{labels:(d=i.product_tags)==null?void 0:d.map(c=>c.value),isPending:i.isPending,additional:i.product_tags&&i.count?i.count-i.product_tags.length:0,isError:i.isError,error:i.error};case"product_types":return{labels:(u=l.product_types)==null?void 0:u.map(c=>c.value),isPending:l.isPending,additional:l.product_types&&l.count?l.count-l.product_types.length:0,isError:l.isError,error:l.error};case"product_collections":return{labels:(g=o.collections)==null?void 0:g.map(c=>c.title),isPending:o.isPending,additional:o.collections&&o.count?o.count-o.collections.length:0,isError:o.isError,error:o.error};case"customer_groups":return{labels:(x=r.customer_groups)==null?void 0:x.map(c=>c.name),isPending:r.isPending,additional:r.customer_groups&&r.count?r.count-r.customer_groups.length:0,isError:r.isError,error:r.error}}},Ee=({isPending:s,action:t,count:a=0,table:i,queryObject:l,prefix:o,children:r})=>{if(s)return e.jsxs("div",{className:"flex flex-col divide-y",children:[Array.from({length:3}).map((c,h)=>e.jsx("div",{className:"bg-ui-bg-field-component h-[52px] w-full animate-pulse"},h)),e.jsx(I,{layout:"fit"})]});const n=Object.values(l).filter(c=>!!c).length===0,d=!s&&a===0&&!n,u=!s&&a===0&&n,{pageIndex:g,pageSize:x}=i.getState().pagination;return e.jsxs("div",{className:"flex flex-col divide-y",children:[e.jsxs("div",{className:"flex flex-col justify-between gap-x-4 gap-y-3 px-6 py-4 md:flex-row md:items-center",children:[e.jsx("div",{children:r}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[!u&&e.jsxs("div",{className:"flex w-full items-center gap-x-2 md:w-fit",children:[e.jsx("div",{className:"w-full md:w-fit",children:e.jsx(U,{prefix:o})}),e.jsx(H,{keys:["name","rate","code","updated_at","created_at"],prefix:o})]}),e.jsx(L,{to:t.to,children:e.jsx(ae,{size:"small",variant:"secondary",children:t.label})})]})]}),d&&e.jsx(W,{}),u&&e.jsx(X,{}),!u&&!d?s?Array.from({length:3}).map((c,h)=>e.jsx("div",{className:"bg-ui-bg-field-component h-[60px] w-full animate-pulse"},h)):i.getRowModel().rows.map(c=>e.jsx(ne,{taxRate:c.original,role:"row","aria-rowindex":c.index},c.id)):null,!u&&e.jsx(O,{prefix:o,canNextPage:i.getCanNextPage(),canPreviousPage:i.getCanPreviousPage(),count:a,nextPage:i.nextPage,previousPage:i.previousPage,pageCount:i.getPageCount(),pageIndex:g,pageSize:x})]})},Oe=({data:s=[],count:t=0,pageSize:a=10,prefix:i})=>{const[l,o]=q(),r=`${i?`${i}_`:""}offset`,n=l.get(r),[{pageIndex:d,pageSize:u},g]=v.useState({pageIndex:n?Math.ceil(Number(n)/a):0,pageSize:a}),x=v.useMemo(()=>({pageIndex:d,pageSize:u}),[d,u]);v.useEffect(()=>{const j=n?Math.ceil(Number(n)/a):0;j!==d&&g(p=>({...p,pageIndex:j}))},[n,a,d]);const c=j=>{const p=j(x),{pageIndex:P,pageSize:S}=p;return o(b=>{if(!P)return b.delete(r),b;const _=new URLSearchParams(b);return _.set(r,String(P*S)),_}),g(p),p};return{table:Z({data:s,columns:[],pageCount:Math.ceil(t/u),state:{pagination:x},getCoreRowModel:ee(),onPaginationChange:c,getPaginationRowModel:se(),manualPagination:!0})}};const ke={widgets:[]},Be={widgets:[]};export{Se as T,ke as a,Be as b,Oe as c,Ee as d,Ce as u};
